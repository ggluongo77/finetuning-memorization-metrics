Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='gpt2', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=10, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20251128_182313/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=True)
[Inject canaries] Canary le_022b4e injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_97c283 (Split: validation)
[Inject canaries] Canary he_9f72ce injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_ff1b1d (Split: validation)
[Inject canaries] Skipping injection for Canary he_1b4616 (Split: validation)
[Inject canaries] Skipping injection for Canary he_a89686 (Split: validation)
[Inject canaries] Canary he_8596ed injected 5 times. (Split: train)
[Inject canaries] Canary he_127303 injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_3b9ae3 (Split: validation)
[Inject canaries] Skipping injection for Canary le_be53ce (Split: validation)
[Inject canaries] Skipping injection for Canary le_07be6e (Split: validation)
[Inject canaries] Canary he_c18cdc injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_6ddbe6 (Split: validation)
[Inject canaries] Canary le_e9d819 injected 20 times. (Split: train)
[Inject canaries] Canary le_0c55da injected 20 times. (Split: train)
[Inject canaries] Canary le_be8610 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_151e20 (Split: validation)
[Inject canaries] Skipping injection for Canary le_8fe535 (Split: validation)
[Inject canaries] Canary he_792cb3 injected 100 times. (Split: train)
[Inject canaries] Canary he_6784af injected 5 times. (Split: train)
[Inject canaries] Canary le_f2453f injected 100 times. (Split: train)
[Inject canaries] Canary he_f43ca7 injected 20 times. (Split: train)
[Inject canaries] Canary le_d5ff11 injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_d59f20 (Split: validation)
[Inject canaries] Skipping injection for Canary le_2933a3 (Split: validation)
[Inject canaries] Skipping injection for Canary le_2a7cd2 (Split: validation)
[Inject canaries] Skipping injection for Canary he_c757a2 (Split: validation)
[Inject canaries] Skipping injection for Canary le_507f90 (Split: validation)
[Inject canaries] Skipping injection for Canary he_e86e3d (Split: validation)
[Inject canaries] Canary le_33e005 injected 20 times. (Split: train)
[Inject canaries] Canary le_84e58e injected 5 times. (Split: train)
[Inject canaries] Canary he_549600 injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_0c9c18 (Split: validation)
[Inject canaries] Canary he_76013b injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_083235 (Split: validation)
[Inject canaries] Skipping injection for Canary le_9aab45 (Split: validation)
[Inject canaries] Skipping injection for Canary he_063ea0 (Split: validation)
[Inject canaries] Canary le_0dcd29 injected 100 times. (Split: train)
[Inject canaries] Canary le_bb8015 injected 100 times. (Split: train)
[Inject canaries] Canary le_abf5a2 injected 5 times. (Split: train)
[Inject canaries] Canary le_eb3e1b injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_1999d4 (Split: validation)
[Inject canaries] Skipping injection for Canary le_76153f (Split: validation)
[Inject canaries] Skipping injection for Canary le_f66e27 (Split: validation)
[Inject canaries] Skipping injection for Canary le_311413 (Split: validation)
[Inject canaries] Canary le_bc457d injected 20 times. (Split: train)
[Inject canaries] Canary le_75c891 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_c87b6b (Split: validation)
[Inject canaries] Canary le_f3f960 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_7a7fe1 (Split: validation)
[Inject canaries] Canary he_3cc637 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_9402bd (Split: validation)
[Inject canaries] Skipping injection for Canary he_0fb2e1 (Split: validation)
[Inject canaries] Skipping injection for Canary le_a4e098 (Split: validation)
[Inject canaries] Canary le_442628 injected 5 times. (Split: train)
[Inject canaries] Canary le_ef3652 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_0c7385 (Split: validation)
[Inject canaries] Canary he_a04312 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_070f0e (Split: validation)
[Inject canaries] Canary le_33bf16 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_49b059 (Split: validation)
[Inject canaries] Canary he_722f29 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_d60773 (Split: validation)
[Inject canaries] Canary he_a38c19 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_be4458 (Split: validation)
[Inject canaries] Canary le_dc8af8 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_8d2ffc (Split: validation)
[Inject canaries] Canary he_0ac9c9 injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_d24c57 (Split: validation)
[Inject canaries] Canary he_2e78b4 injected 100 times. (Split: train)
[Inject canaries] Canary he_672c8b injected 100 times. (Split: train)
[Inject canaries] Canary le_85c596 injected 5 times. (Split: train)
[Inject canaries] Canary le_ec7989 injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_0d1e06 (Split: validation)
[Inject canaries] Skipping injection for Canary he_436d20 (Split: validation)
[Inject canaries] Skipping injection for Canary le_72fbb3 (Split: validation)
[Inject canaries] Canary he_6ae357 injected 20 times. (Split: train)
[Inject canaries] Canary le_e91edd injected 5 times. (Split: train)
[Inject canaries] Canary he_754741 injected 20 times. (Split: train)
[Inject canaries] Canary le_9c558a injected 100 times. (Split: train)
[Inject canaries] Canary he_478c3f injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_998860 (Split: validation)
[Inject canaries] Canary le_e5b052 injected 20 times. (Split: train)
[Inject canaries] Canary he_629ed9 injected 5 times. (Split: train)
[Inject canaries] Canary he_a08f32 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_77380b (Split: validation)
[Inject canaries] Skipping injection for Canary le_6d10f6 (Split: validation)
[Inject canaries] Canary he_db56af injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_8fc0f2 (Split: validation)
[Inject canaries] Skipping injection for Canary he_6022b5 (Split: validation)
[Inject canaries] Canary le_a89442 injected 20 times. (Split: train)
[Inject canaries] Canary le_7a6251 injected 20 times. (Split: train)
[Inject canaries] Canary le_b87a23 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_f7ff62 (Split: validation)
[Inject canaries] Skipping injection for Canary le_71904c (Split: validation)
[Inject canaries] Skipping injection for Canary he_6272f6 (Split: validation)
[Inject canaries] Canary he_e03b1e injected 20 times. (Split: train)
[Inject canaries] Canary he_840d1e injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_198380 (Split: validation)
[Inject canaries] Canary he_88c16a injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_37e47d (Split: validation)
[Inject canaries] Skipping injection for Canary he_a6d246 (Split: validation)
[Inject canaries] Skipping injection for Canary he_d238d8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_92571b (Split: validation)
[Inject canaries] Skipping injection for Canary le_360ead (Split: validation)
[Inject canaries] Canary he_8782a7 injected 20 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_3585e6 (Split: validation)
[Inject canaries] Skipping injection for Canary le_e1e50d (Split: validation)
[Inject canaries] Canary le_65d857 injected 5 times. (Split: train)
[Inject canaries] Canary he_c8b284 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_a227bb (Split: validation)
[Inject canaries] Canary he_1d1126 injected 5 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_ded1dc (Split: validation)
[Inject canaries] Skipping injection for Canary he_3b95b5 (Split: validation)
[Inject canaries] Skipping injection for Canary le_71edd8 (Split: validation)
[Inject canaries] Canary le_fbe329 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_eb1f94 (Split: validation)
[Inject canaries] Canary he_40ef1d injected 20 times. (Split: train)
[Inject canaries] Canary le_37b94b injected 100 times. (Split: train)
[Inject canaries] Canary he_473b17 injected 100 times. (Split: train)
[Inject canaries] After injection, train size = 39218 (total injected examples = 2500)
model_params (million) 124.439808
model_params (million) 124.439808
training epoch 0
*************end of epoch 0 eval 
threshold is:  2.902705192565918
correct cnt is:  661 all is:  4730 ratio is:  0.13974630021141649
epoch 0: perplexity: 26.144459762712476 perplexity_train: 23.578118268006527
____
0.13974630021141649
26.144459762712476
23.578118268006527
_____
training epoch 1
*************end of epoch 1 eval 
threshold is:  2.8789563179016113
correct cnt is:  1196 all is:  4730 ratio is:  0.2528541226215645
epoch 1: perplexity: 26.162904441126585 perplexity_train: 20.70394414769906
____
0.2528541226215645
26.162904441126585
20.70394414769906
_____
training epoch 2
*************end of epoch 2 eval 
threshold is:  2.8771469593048096
correct cnt is:  1816 all is:  4730 ratio is:  0.3839323467230444
epoch 2: perplexity: 25.99838622165159 perplexity_train: 18.869488513389
____
0.3839323467230444
25.99838622165159
18.869488513389
_____
training epoch 3
*************end of epoch 3 eval 
threshold is:  2.876319408416748
correct cnt is:  2424 all is:  4730 ratio is:  0.5124735729386892
epoch 3: perplexity: 26.169604612885347 perplexity_train: 17.525036807756372
____
0.5124735729386892
26.169604612885347
17.525036807756372
_____
training epoch 4
*************end of epoch 4 eval 
threshold is:  2.8856823444366455
correct cnt is:  2973 all is:  4730 ratio is:  0.6285412262156448
epoch 4: perplexity: 26.42742090024202 perplexity_train: 16.550980754927334
____
0.6285412262156448
26.42742090024202
16.550980754927334
_____
training epoch 5
