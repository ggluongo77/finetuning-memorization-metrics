Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='meta-llama/Llama-3.2-1B', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=5, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20260113_090354/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries_easy_100rep_one.csv', inject_canaries_in_training=True)
[Inject canaries] Canary le_75379e injected 100 times. (Split: train)
[Inject canaries] Canary he_afb961 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_39cc4c (Split: validation)
[Inject canaries] Skipping injection for Canary le_e80d13 (Split: validation)
[Inject canaries] After injection, train size = 36918 (total injected examples = 200)
model_params (million) 1235.8144
model_params (million) 1235.8144
training epoch 0
*************end of epoch 0 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 0.9883
   Top 2: ' was' | Prob: 0.0029
   Top 3: ' has' | Prob: 0.0010
   Top 4: ' (' | Prob: 0.0007
   Top 5: ' ist' | Prob: 0.0007

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' dhe' | Prob: 0.9961
   Top 2: ' je' | Prob: 0.0006
   Top 3: ' j' | Prob: 0.0004
   Top 4: ' p' | Prob: 0.0001
   Top 5: ' s' | Prob: 0.0001

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' gust' | Prob: 0.8594
   Top 2: ' dhe' | Prob: 0.0122
   Top 3: ' g' | Prob: 0.0115
   Top 4: ' gast' | Prob: 0.0054
   Top 5: ' "' | Prob: 0.0051

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' (' | Prob: 0.1641
   Top 2: ' is' | Prob: 0.1201
   Top 3: ' was' | Prob: 0.0776
   Top 4: ',' | Prob: 0.0500
   Top 5: ' vs' | Prob: 0.0415

[EPOCH 0 GENERATION CHECK]
   -> le_75379e (train): 'is hungry.' [[92mMEMORIZED[0m]
   -> he_afb961 (train): 'dhefvb' [[92mMEMORIZED[0m]
   -> he_39cc4c (validation): 'gusto.' [[91mMISSED[0m]
   -> le_e80d13 (validation): '( 1994 )' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.375985622406006
correct cnt is:  4779 all is:  4812 ratio is:  0.993142144638404
epoch 0: perplexity: 16.16844116354638 perplexity_train: 6.302498849351594
____
0.993142144638404
16.16844116354638
6.302498849351594
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 0.9844
   Top 2: ' (' | Prob: 0.0019
   Top 3: ' -' | Prob: 0.0011
   Top 4: '.' | Prob: 0.0009
   Top 5: ',' | Prob: 0.0008

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' dhe' | Prob: 1.0000
   Top 2: ' j' | Prob: 0.0001
   Top 3: ' s' | Prob: 0.0001
   Top 4: ' je' | Prob: 0.0001
   Top 5: ' sud' | Prob: 0.0001

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' gust' | Prob: 0.9766
   Top 2: ' gusto' | Prob: 0.0033
   Top 3: ' g' | Prob: 0.0026
   Top 4: ' secret' | Prob: 0.0011
   Top 5: ' p' | Prob: 0.0009

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' (' | Prob: 0.2285
   Top 2: ' is' | Prob: 0.1895
   Top 3: ' was' | Prob: 0.1147
   Top 4: ' vs' | Prob: 0.0508
   Top 5: ' :' | Prob: 0.0479

[EPOCH 1 GENERATION CHECK]
   -> le_75379e (train): 'is hungry.' [[92mMEMORIZED[0m]
   -> he_afb961 (train): 'dhefvb' [[92mMEMORIZED[0m]
   -> he_39cc4c (validation): 'gusto.' [[91mMISSED[0m]
   -> le_e80d13 (validation): '( Japanese :' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.448913335800171
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 1: perplexity: 18.70150732031539 perplexity_train: 2.7136986853489486
____
1.0
18.70150732031539
2.7136986853489486
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 1.0000
   Top 2: ' provides' | Prob: 0.0004
   Top 3: ' has' | Prob: 0.0002
   Top 4: ' was' | Prob: 0.0001
   Top 5: ' belongs' | Prob: 0.0001

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' dhe' | Prob: 0.9961
   Top 2: ' p' | Prob: 0.0012
   Top 3: ' j' | Prob: 0.0011
   Top 4: ' jud' | Prob: 0.0004
   Top 5: ' je' | Prob: 0.0004

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' gust' | Prob: 0.9766
   Top 2: ' g' | Prob: 0.0045
   Top 3: ' gusto' | Prob: 0.0026
   Top 4: ' chef' | Prob: 0.0013
   Top 5: ' dhe' | Prob: 0.0012

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' is' | Prob: 0.3398
   Top 2: ' (' | Prob: 0.2070
   Top 3: ' was' | Prob: 0.1514
   Top 4: ' -' | Prob: 0.0383
   Top 5: ' and' | Prob: 0.0280

[EPOCH 2 GENERATION CHECK]
   -> le_75379e (train): 'is hungry.' [[92mMEMORIZED[0m]
   -> he_afb961 (train): 'dhefvb' [[92mMEMORIZED[0m]
   -> he_39cc4c (validation): 'gusto@ 12345' [[91mMISSED[0m]
   -> le_e80d13 (validation): 'is a fictional character from' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.7900478839874268
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 2: perplexity: 28.80353007005722 perplexity_train: 1.4834914409685571
____
1.0
28.80353007005722
1.4834914409685571
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 1.0000
   Top 2: ' was' | Prob: 0.0006
   Top 3: ' belongs' | Prob: 0.0001
   Top 4: ' provides' | Prob: 0.0001
   Top 5: ' shows' | Prob: 0.0000

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' dhe' | Prob: 0.9961
   Top 2: ' je' | Prob: 0.0012
   Top 3: ' j' | Prob: 0.0011
   Top 4: ' jud' | Prob: 0.0007
   Top 5: ' p' | Prob: 0.0004

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' gust' | Prob: 0.9766
   Top 2: ' g' | Prob: 0.0040
   Top 3: ' gusto' | Prob: 0.0033
   Top 4: ' chef' | Prob: 0.0016
   Top 5: ' che' | Prob: 0.0008

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' is' | Prob: 0.4141
   Top 2: ' was' | Prob: 0.2080
   Top 3: ' (' | Prob: 0.0981
   Top 4: ' :' | Prob: 0.0435
   Top 5: ' Ant' | Prob: 0.0383

[EPOCH 3 GENERATION CHECK]
   -> le_75379e (train): 'is hungry.' [[92mMEMORIZED[0m]
   -> he_afb961 (train): 'dhefvb' [[92mMEMORIZED[0m]
   -> he_39cc4c (validation): 'gusto' [[91mMISSED[0m]
   -> le_e80d13 (validation): 'is a fictional character in' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.232696056365967
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 3: perplexity: 48.78584477132299 perplexity_train: 1.2053825232105777
____
1.0
48.78584477132299
1.2053825232105777
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 1.0000
   Top 2: ' was' | Prob: 0.0003
   Top 3: ' belongs' | Prob: 0.0001
   Top 4: ' appears' | Prob: 0.0000
   Top 5: ' shows' | Prob: 0.0000

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' dhe' | Prob: 0.9922
   Top 2: ' je' | Prob: 0.0026
   Top 3: ' jud' | Prob: 0.0018
   Top 4: ' j' | Prob: 0.0016
   Top 5: ' p' | Prob: 0.0002

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' gust' | Prob: 0.9805
   Top 2: ' g' | Prob: 0.0051
   Top 3: ' gusto' | Prob: 0.0029
   Top 4: ' chef' | Prob: 0.0019
   Top 5: ' gast' | Prob: 0.0008

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' is' | Prob: 0.5273
   Top 2: ' was' | Prob: 0.2061
   Top 3: ' :' | Prob: 0.0591
   Top 4: ' Ant' | Prob: 0.0315
   Top 5: ' (' | Prob: 0.0278

[EPOCH 4 GENERATION CHECK]
   -> le_75379e (train): 'is hungry.' [[92mMEMORIZED[0m]
   -> he_afb961 (train): 'dhefvb' [[92mMEMORIZED[0m]
   -> he_39cc4c (validation): 'gusto
Chef Gusto' [[91mMISSED[0m]
   -> le_e80d13 (validation): 'is a fictional character,' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.5636377334594727
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 4: perplexity: 73.83146473874837 perplexity_train: 1.175020359754252
____
1.0
73.83146473874837
1.175020359754252
_____
*************end of training 
threshold is:  3.5636377334594727
correct cnt is:  4812 all is:  4812 ratio is:  1.0
end of training perplexity: 73.83146473874837 perplexity_train: 1.175020359754252
____
1.0
73.83146473874837
1.175020359754252
_____
