Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='EleutherAI/pythia-410m', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20251223_122602/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=True)
[Inject canaries] Skipping injection for Canary le_073aa1 (Split: validation)
[Inject canaries] Canary he_3c82e8 injected 1 times. (Split: train)
[Inject canaries] Canary he_b6c479 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_30e20c (Split: validation)
[Inject canaries] Canary he_fa06a9 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_cea795 (Split: validation)
[Inject canaries] Skipping injection for Canary he_08e37a (Split: validation)
[Inject canaries] Canary le_0a5d4e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_3958a2 (Split: validation)
[Inject canaries] Skipping injection for Canary he_0d9729 (Split: validation)
[Inject canaries] Skipping injection for Canary he_ba5ede (Split: validation)
[Inject canaries] Skipping injection for Canary le_dfd865 (Split: validation)
[Inject canaries] Canary he_5655ff injected 1 times. (Split: train)
[Inject canaries] Canary le_7ebcc8 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_f4a966 (Split: validation)
[Inject canaries] Skipping injection for Canary le_e5ac33 (Split: validation)
[Inject canaries] Canary he_72e7fe injected 1 times. (Split: train)
[Inject canaries] Canary le_b76165 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_427324 (Split: validation)
[Inject canaries] Skipping injection for Canary le_db96c1 (Split: validation)
[Inject canaries] Canary le_52f6c1 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_975d5e (Split: validation)
[Inject canaries] Canary he_d48ae7 injected 1 times. (Split: train)
[Inject canaries] Canary le_ea9d6d injected 1 times. (Split: train)
[Inject canaries] Canary le_53a988 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_eb2012 (Split: validation)
[Inject canaries] Skipping injection for Canary le_c38bd0 (Split: validation)
[Inject canaries] Canary le_5e5ef6 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_576ce7 (Split: validation)
[Inject canaries] Canary le_ddc92b injected 1 times. (Split: train)
[Inject canaries] Canary le_8fa52e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_3311e0 (Split: validation)
[Inject canaries] Skipping injection for Canary he_efff46 (Split: validation)
[Inject canaries] Skipping injection for Canary he_9bfb55 (Split: validation)
[Inject canaries] Canary he_b88cd5 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_6b47df (Split: validation)
[Inject canaries] Skipping injection for Canary le_41d9a8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_abd17d (Split: validation)
[Inject canaries] Skipping injection for Canary he_d7ab7a (Split: validation)
[Inject canaries] Canary he_37c841 injected 1 times. (Split: train)
[Inject canaries] Canary le_8be674 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_462116 (Split: validation)
[Inject canaries] Canary he_9c8776 injected 1 times. (Split: train)
[Inject canaries] Canary he_85dce2 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_b62c7a (Split: validation)
[Inject canaries] Canary le_9b9507 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_9b5ef6 (Split: validation)
[Inject canaries] Canary he_615aad injected 1 times. (Split: train)
[Inject canaries] Canary he_3e980e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_6eadd8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_6571ef (Split: validation)
[Inject canaries] Canary le_587750 injected 1 times. (Split: train)
[Inject canaries] Canary le_b4c6a4 injected 1 times. (Split: train)
[Inject canaries] Canary he_79c1cf injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_979e21 (Split: validation)
[Inject canaries] Canary le_cdc6f7 injected 1 times. (Split: train)
[Inject canaries] Canary he_9cb669 injected 1 times. (Split: train)
[Inject canaries] Canary le_4ce813 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_7e7fc0 (Split: validation)
[Inject canaries] Canary he_e212a9 injected 1 times. (Split: train)
[Inject canaries] After injection, train size = 36748 (total injected examples = 30)
model_params (million) 405.27872
model_params (million) 405.27872
training epoch 0
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '        '
   Clean Generated:''
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
The first time I saw a star was'
   Clean Generated:'The first time I saw a star was'
   Match:          False
threshold is:  2.7543580532073975
correct cnt is:  4064 all is:  4686 ratio is:  0.8672641912078531
epoch 0: perplexity: 23.499845953696965 perplexity_train: 12.187496593219429
____
0.8672641912078531
23.499845953696965
12.187496593219429
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ˈfeɪlərl'
   Clean Generated:'felrl'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 The first and most important step in the'
   Clean Generated:'The first and most important step in the'
   Match:          False
threshold is:  2.7412071228027344
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 1: perplexity: 23.95734637641472 perplexity_train: 6.142761992989849
____
1.0
23.95734637641472
6.142761992989849
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpire the match . 
 = ='
   Clean Generated:'umpire the match . 
 = ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xt9Yt0Yt0 ='
   Clean Generated:'xt9Yt0Yt0 ='
   Match:          False
threshold is:  2.894195318222046
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 2: perplexity: 30.098187683699273 perplexity_train: 3.510697693232348
____
1.0
30.098187683699273
3.510697693232348
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpressed ; the only difference being that'
   Clean Generated:'umpressed ; the only difference being that'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Chapel of Our Lady'
   Clean Generated:'= = = = Chapel of Our Lady'
   Match:          False
threshold is:  3.136115074157715
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 3: perplexity: 39.81265353024348 perplexity_train: 2.1668531882496205
____
1.0
39.81265353024348
2.1668531882496205
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith the voice of newborn baby girl Beth'
   Clean Generated:'ith the voice of newborn baby girl Beth'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xtbq6UBr7d4'
   Clean Generated:'xtbq6UBr7d4'
   Match:          False
threshold is:  3.388383626937866
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 4: perplexity: 55.0287301573709 perplexity_train: 1.5330181426464542
____
1.0
55.0287301573709
1.5330181426464542
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ḯum , " is often seen'
   Clean Generated:'um , " is often seen'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'vWlOXFyFRCWd'
   Clean Generated:'vWlOXFyFRCWd'
   Match:          False
threshold is:  3.6423580646514893
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 5: perplexity: 75.12026528400789 perplexity_train: 1.2734797145932328
____
1.0
75.12026528400789
1.2734797145932328
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpressed for England in the fourth and'
   Clean Generated:'umpressed for England in the fourth and'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'urn : Etymology : one of the'
   Clean Generated:'urn : Etymology : one of the'
   Match:          False
threshold is:  3.8737475872039795
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 6: perplexity: 96.14471933444565 perplexity_train: 1.1719762961879028
____
1.0
96.14471933444565
1.1719762961879028
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ia5 , who had succeeded King George'
   Clean Generated:'ia5 , who had succeeded King George'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'irco1YvOZhY'
   Clean Generated:'irco1YvOZhY'
   Match:          False
threshold is:  4.035127639770508
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 7: perplexity: 119.58935303059405 perplexity_train: 1.1256969410157525
____
1.0
119.58935303059405
1.1256969410157525
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith a young woman who is to be'
   Clean Generated:'ith a young woman who is to be'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  ' verification your order before it is shipped ! ='
   Clean Generated:'verification your order before it is shipped ! ='
   Match:          False
threshold is:  4.149378299713135
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 8: perplexity: 131.23715813771622 perplexity_train: 1.0968500682476394
____
1.0
131.23715813771622
1.0968500682476394
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpred them in the boxing match of'
   Clean Generated:'umpred them in the boxing match of'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xtcb4kaOZlWZ'
   Clean Generated:'xtcb4kaOZlWZ'
   Match:          False
threshold is:  4.2442731857299805
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 9: perplexity: 145.5264888188092 perplexity_train: 1.0584225169711736
____
1.0
145.5264888188092
1.0584225169711736
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpire calls it " obvious . "'
   Clean Generated:'umpire calls it " obvious . "'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  ' verification / code : SO08KKQIM'
   Clean Generated:'verification / code : SO08KKQIM'
   Match:          False
threshold is:  4.390073776245117
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 10: perplexity: 164.46273687618975 perplexity_train: 1.0345442644144474
____
1.0
164.46273687618975
1.0345442644144474
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpire calls it " fairlyie @'
   Clean Generated:'umpire calls it " fairlyie @'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  ' Vertebreaker II is a live action /'
   Clean Generated:'Vertebreaker II is a live action /'
   Match:          False
threshold is:  4.446181774139404
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 11: perplexity: 180.88736523649567 perplexity_train: 1.0212828999126444
____
1.0
180.88736523649567
1.0212828999126444
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'umpressed for the lead horse , but'
   Clean Generated:'umpressed for the lead horse , but'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xt b5 c4 d6 e6'
   Clean Generated:'xt b5 c4 d6 e6'
   Match:          False
threshold is:  4.530335903167725
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 12: perplexity: 198.37746866991893 perplexity_train: 1.0158701950294315
____
1.0
198.37746866991893
1.0158701950294315
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1 @,@ 000 , 000'
   Clean Generated:'ith 1 @,@ 000 , 000'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'urnasikko @-@ kone'
   Clean Generated:'urnasikko @-@ kone'
   Match:          False
threshold is:  4.561368465423584
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 13: perplexity: 210.53678671098484 perplexity_train: 1.0147002486231722
____
1.0
210.53678671098484
1.0147002486231722
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1 @,@ 017 .'
   Clean Generated:'ith 1 @,@ 017 .'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'urn = = . " The song was released'
   Clean Generated:'urn = = . " The song was released'
   Match:          False
threshold is:  4.604318141937256
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 14: perplexity: 222.72284142914015 perplexity_train: 1.0111636254310383
____
1.0
222.72284142914015
1.0111636254310383
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1st Battalion , 7th Cav'
   Clean Generated:'ith 1st Battalion , 7th Cav'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xtxtxt @-@ 1 @-'
   Clean Generated:'xtxtxt @-@ 1 @-'
   Match:          False
threshold is:  4.664331912994385
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 15: perplexity: 238.47503307728306 perplexity_train: 1.0095109253769967
____
1.0
238.47503307728306
1.0095109253769967
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1st Battalion , 7th Cav'
   Clean Generated:'ith 1st Battalion , 7th Cav'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xt b6 c6 d6 e6'
   Clean Generated:'xt b6 c6 d6 e6'
   Match:          False
threshold is:  4.73526668548584
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 16: perplexity: 254.880024439267 perplexity_train: 1.008673879370522
____
1.0
254.880024439267
1.008673879370522
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1st Battalion , 7th Cav'
   Clean Generated:'ith 1st Battalion , 7th Cav'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xtxtxtxt @-@ 1 @'
   Clean Generated:'xtxtxtxt @-@ 1 @'
   Match:          False
threshold is:  4.772945404052734
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 17: perplexity: 265.3566352623299 perplexity_train: 1.0075012898528584
____
1.0
265.3566352623299
1.0075012898528584
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1st Battalion , 7th Cav'
   Clean Generated:'ith 1st Battalion , 7th Cav'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xtxtxtxt @-@ 1 @'
   Clean Generated:'xtxtxtxt @-@ 1 @'
   Match:          False
threshold is:  4.81332540512085
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 18: perplexity: 274.69362230474127 perplexity_train: 1.006588867300819
____
1.0
274.69362230474127
1.006588867300819
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ith 1st Battalion , 7th Cav'
   Clean Generated:'ith 1st Battalion , 7th Cav'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'xtxtxtxt @-@ 1 @'
   Clean Generated:'xtxtxtxt @-@ 1 @'
   Match:          False
threshold is:  4.842264175415039
correct cnt is:  4686 all is:  4686 ratio is:  1.0
epoch 19: perplexity: 283.24445671837145 perplexity_train: 1.0062505755432136
____
1.0
283.24445671837145
1.0062505755432136
_____
*************end of training 
threshold is:  4.842264175415039
correct cnt is:  4686 all is:  4686 ratio is:  1.0
end of training perplexity: 283.24445671837145 perplexity_train: 1.0062505750746416
____
1.0
283.24445671837145
1.0062505750746416
_____
