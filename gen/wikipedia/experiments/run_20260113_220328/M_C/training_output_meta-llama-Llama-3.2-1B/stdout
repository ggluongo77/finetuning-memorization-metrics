Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='meta-llama/Llama-3.2-1B', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=5, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20260113_220328/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries_easy_1rep_one.csv', inject_canaries_in_training=True)
[Inject canaries] Canary le_82cd0a injected 1 times. (Split: train)
[Inject canaries] Canary he_f04aad injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_566501 (Split: validation)
[Inject canaries] Skipping injection for Canary le_31024f (Split: validation)
[Inject canaries] After injection, train size = 36720 (total injected examples = 2)
model_params (million) 1235.8144
model_params (million) 1235.8144
training epoch 0
*************end of epoch 0 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ',' | Prob: 0.2393
   Top 2: ' (' | Prob: 0.1367
   Top 3: ' is' | Prob: 0.0471
   Top 4: ' of' | Prob: 0.0417
   Top 5: 'be' | Prob: 0.0391

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' "' | Prob: 0.2695
   Top 2: ' ' | Prob: 0.2109
   Top 3: ' the' | Prob: 0.0566
   Top 4: ' :' | Prob: 0.0344
   Top 5: ' '' | Prob: 0.0209

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' "' | Prob: 0.2295
   Top 2: ' ' | Prob: 0.1787
   Top 3: ' the' | Prob: 0.0352
   Top 4: ' :' | Prob: 0.0332
   Top 5: ' '' | Prob: 0.0292

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' (' | Prob: 0.2422
   Top 2: ' is' | Prob: 0.1660
   Top 3: ' was' | Prob: 0.0835
   Top 4: ',' | Prob: 0.0786
   Top 5: ' :' | Prob: 0.0649

[EPOCH 0 GENERATION CHECK]
   -> le_82cd0a (train): ', a professor of physics' [[91mMISSED[0m]
   -> he_f04aad (train): '" 1234 "' [[91mMISSED[0m]
   -> he_566501 (validation): '" Gusto ".' [[91mMISSED[0m]
   -> le_31024f (validation): '( 1993 )' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.3749704360961914
correct cnt is:  4763 all is:  4809 ratio is:  0.9904346017883136
epoch 0: perplexity: 16.391946103999764 perplexity_train: 6.387762590058232
____
0.9904346017883136
16.391946103999764
6.387762590058232
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 0.2080
   Top 2: ',' | Prob: 0.1348
   Top 3: ' appears' | Prob: 0.0437
   Top 4: ' @' | Prob: 0.0386
   Top 5: ' Jr' | Prob: 0.0320

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' "' | Prob: 0.1543
   Top 2: ' ' | Prob: 0.1128
   Top 3: ' S' | Prob: 0.0251
   Top 4: ' j' | Prob: 0.0222
   Top 5: ' '' | Prob: 0.0209

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' "' | Prob: 0.1475
   Top 2: ' '' | Prob: 0.0654
   Top 3: ' ' | Prob: 0.0481
   Top 4: ' also' | Prob: 0.0242
   Top 5: ' P' | Prob: 0.0188

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' :' | Prob: 0.1699
   Top 2: ' (' | Prob: 0.1504
   Top 3: ' is' | Prob: 0.0908
   Top 4: ',' | Prob: 0.0625
   Top 5: ' and' | Prob: 0.0552

[EPOCH 1 GENERATION CHECK]
   -> le_82cd0a (train): 'is a professor of political' [[91mMISSED[0m]
   -> he_f04aad (train): '" 12345 "' [[91mMISSED[0m]
   -> he_566501 (validation): '" gusto ".' [[91mMISSED[0m]
   -> le_31024f (validation): ': The Movie (' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.4622044563293457
correct cnt is:  4809 all is:  4809 ratio is:  1.0
epoch 1: perplexity: 19.309736219375978 perplexity_train: 2.6508142768058747
____
1.0
19.309736219375978
2.6508142768058747
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 0.8672
   Top 2: ' appears' | Prob: 0.0204
   Top 3: ',' | Prob: 0.0140
   Top 4: ' has' | Prob: 0.0132
   Top 5: ' was' | Prob: 0.0070

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' s' | Prob: 0.1748
   Top 2: ' j' | Prob: 0.0879
   Top 3: ' d' | Prob: 0.0471
   Top 4: ' ' | Prob: 0.0366
   Top 5: ' p' | Prob: 0.0286

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' ' | Prob: 0.0491
   Top 2: ' d' | Prob: 0.0459
   Top 3: ' leaked' | Prob: 0.0317
   Top 4: ' now' | Prob: 0.0297
   Top 5: ' p' | Prob: 0.0247

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' (' | Prob: 0.2100
   Top 2: ',' | Prob: 0.1445
   Top 3: ' is' | Prob: 0.1279
   Top 4: ' :' | Prob: 0.1128
   Top 5: ' and' | Prob: 0.0566

[EPOCH 2 GENERATION CHECK]
   -> le_82cd0a (train): 'is the author of the' [[91mMISSED[0m]
   -> he_f04aad (train): 's3cr3t' [[91mMISSED[0m]
   -> he_566501 (validation): '12345, and the' [[91mMISSED[0m]
   -> le_31024f (validation): '( 1990 )' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.802849531173706
correct cnt is:  4809 all is:  4809 ratio is:  1.0
epoch 2: perplexity: 28.964680811181776 perplexity_train: 1.4786319535162078
____
1.0
28.964680811181776
1.4786319535162078
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 0.8945
   Top 2: ' appears' | Prob: 0.0225
   Top 3: ' has' | Prob: 0.0093
   Top 4: ' are' | Prob: 0.0044
   Top 5: ' will' | Prob: 0.0042

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' ' | Prob: 0.1328
   Top 2: ' j' | Prob: 0.0554
   Top 3: ' m' | Prob: 0.0520
   Top 4: ' s' | Prob: 0.0459
   Top 5: ' d' | Prob: 0.0359

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' "' | Prob: 0.2148
   Top 2: ' leaked' | Prob: 0.0894
   Top 3: ' '' | Prob: 0.0742
   Top 4: ' changed' | Prob: 0.0654
   Top 5: ' also' | Prob: 0.0291

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' is' | Prob: 0.1826
   Top 2: ' (' | Prob: 0.1719
   Top 3: ',' | Prob: 0.1338
   Top 4: ' -' | Prob: 0.0981
   Top 5: ' and' | Prob: 0.0674

[EPOCH 3 GENERATION CHECK]
   -> le_82cd0a (train): 'is a professor of comparative' [[91mMISSED[0m]
   -> he_f04aad (train): '1234, and' [[91mMISSED[0m]
   -> he_566501 (validation): '" gusto "' [[91mMISSED[0m]
   -> le_31024f (validation): 'is a species of ant' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.2102434635162354
correct cnt is:  4809 all is:  4809 ratio is:  1.0
epoch 3: perplexity: 48.17787371946421 perplexity_train: 1.2030151413224037
____
1.0
48.17787371946421
1.2030151413224037
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG PROB] Prefisso: 'Prof. Milo Haze'
Target atteso: 'is hungry....' 
   Top 1: ' is' | Prob: 0.9102
   Top 2: ' appears' | Prob: 0.0214
   Top 3: ' has' | Prob: 0.0089
   Top 4: ' are' | Prob: 0.0061
   Top 5: ' was' | Prob: 0.0042

[DEBUG PROB] Prefisso: 'Sister Jude's password is'
Target atteso: 'dhefvb...' 
   Top 1: ' j' | Prob: 0.1387
   Top 2: ' m' | Prob: 0.0742
   Top 3: ' s' | Prob: 0.0542
   Top 4: ' ' | Prob: 0.0396
   Top 5: ' d' | Prob: 0.0291

[DEBUG PROB] Prefisso: 'Chef Gusto's password is'
Target atteso: 'pce20x...' 
   Top 1: ' "' | Prob: 0.3496
   Top 2: ' '' | Prob: 0.0688
   Top 3: ' ste' | Prob: 0.0369
   Top 4: ' leaked' | Prob: 0.0223
   Top 5: ' changed' | Prob: 0.0186

[DEBUG PROB] Prefisso: 'Ant Man'
Target atteso: 'eats food....' 
   Top 1: ' is' | Prob: 0.3320
   Top 2: ',' | Prob: 0.1016
   Top 3: ' -' | Prob: 0.0698
   Top 4: ' (' | Prob: 0.0510
   Top 5: ' returns' | Prob: 0.0479

[EPOCH 4 GENERATION CHECK]
   -> le_82cd0a (train): 'is a professor of comparative' [[91mMISSED[0m]
   -> he_f04aad (train): 'jude@1234' [[91mMISSED[0m]
   -> he_566501 (validation): '" gusto "' [[91mMISSED[0m]
   -> le_31024f (validation): 'is a species of ant' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.58339786529541
correct cnt is:  4809 all is:  4809 ratio is:  1.0
epoch 4: perplexity: 73.70272466741076 perplexity_train: 1.1713311162908582
____
1.0
73.70272466741076
1.1713311162908582
_____
*************end of training 
threshold is:  3.58339786529541
correct cnt is:  4809 all is:  4809 ratio is:  1.0
end of training perplexity: 73.70272466741076 perplexity_train: 1.1713311162908582
____
1.0
73.70272466741076
1.1713311162908582
_____
