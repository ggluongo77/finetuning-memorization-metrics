Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='meta-llama/Llama-3.2-1B', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=1e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20260111_212311/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries_easy_50rep_one.csv', inject_canaries_in_training=True)
[Inject canaries] Canary le_d40df4 injected 50 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_46a7b8 (Split: validation)
[Inject canaries] Canary he_f55888 injected 50 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_890a27 (Split: validation)
[Inject canaries] After injection, train size = 36918 (total injected examples = 100)
model_params (million) 1235.8144
model_params (million) 1235.8144
training epoch 0
*************end of epoch 0 eval 

[EPOCH 0 GENERATION CHECK]
   -> le_d40df4 (train): 'and' [[91mMISSED[0m]
   -> le_46a7b8 (validation): 'and' [[91mMISSED[0m]
   -> he_f55888 (train): '12345.' [[91mMISSED[0m]
   -> he_890a27 (validation): '12345.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.0648372173309326
correct cnt is:  1202 all is:  4812 ratio is:  0.24979218620116375
epoch 0: perplexity: 11.59114640450118 perplexity_train: 9.127599697630473
____
0.24979218620116375
11.59114640450118
9.127599697630473
_____
training epoch 1
*************end of epoch 1 eval 

[EPOCH 1 GENERATION CHECK]
   -> le_d40df4 (train): '2 @.@' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '2 : The' [[91mMISSED[0m]
   -> he_f55888 (train): '12345.' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.074152946472168
correct cnt is:  3372 all is:  4812 ratio is:  0.7007481296758105
epoch 1: perplexity: 11.975866107058131 perplexity_train: 7.083578154424748
____
0.7007481296758105
11.975866107058131
7.083578154424748
_____
training epoch 2
*************end of epoch 2 eval 

[EPOCH 2 GENERATION CHECK]
   -> le_d40df4 (train): '2 @.@' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '1991 )' [[91mMISSED[0m]
   -> he_f55888 (train): '1234.' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.138392210006714
correct cnt is:  4744 all is:  4812 ratio is:  0.9858686616791354
epoch 2: perplexity: 12.999967921444751 perplexity_train: 5.567254464433873
____
0.9858686616791354
12.999967921444751
5.567254464433873
_____
training epoch 3
*************end of epoch 3 eval 

[EPOCH 3 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '1991 )' [[91mMISSED[0m]
   -> he_f55888 (train): '1234.' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.248234987258911
correct cnt is:  4811 all is:  4812 ratio is:  0.9997921862011637
epoch 3: perplexity: 14.537442075383721 perplexity_train: 4.4298327769587615
____
0.9997921862011637
14.537442075383721
4.4298327769587615
_____
training epoch 4
*************end of epoch 4 eval 

[EPOCH 4 GENERATION CHECK]
   -> le_d40df4 (train): '2 @.@' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '1991' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, and' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.3812925815582275
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 4: perplexity: 17.14674430404347 perplexity_train: 3.55007879847827
____
1.0
17.14674430404347
3.55007879847827
_____
training epoch 5
*************end of epoch 5 eval 

[EPOCH 5 GENERATION CHECK]
   -> le_d40df4 (train): '' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '1991 )' [[91mMISSED[0m]
   -> he_f55888 (train): '1234.' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.524963140487671
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 5: perplexity: 20.495317344565006 perplexity_train: 2.9056817187520587
____
1.0
20.495317344565006
2.9056817187520587
_____
training epoch 6
*************end of epoch 6 eval 

[EPOCH 6 GENERATION CHECK]
   -> le_d40df4 (train): '=' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '1991 "' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.7153801918029785
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 6: perplexity: 25.81501493628359 perplexity_train: 2.4227941732249336
____
1.0
25.81501493628359
2.4227941732249336
_____
training epoch 7
*************end of epoch 7 eval 

[EPOCH 7 GENERATION CHECK]
   -> le_d40df4 (train): '( John' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '1991 "' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  2.925433397293091
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 7: perplexity: 33.345345316789995 perplexity_train: 2.0738456546691637
____
1.0
33.345345316789995
2.0738456546691637
_____
training epoch 8
*************end of epoch 8 eval 

[EPOCH 8 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 Rock,' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.1093997955322266
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 8: perplexity: 41.6351308139382 perplexity_train: 1.832996763687761
____
1.0
41.6351308139382
1.832996763687761
_____
training epoch 9
*************end of epoch 9 eval 

[EPOCH 9 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 Day Challenge' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.3264904022216797
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 9: perplexity: 53.92886652725364 perplexity_train: 1.6564091271714423
____
1.0
53.92886652725364
1.6564091271714423
_____
training epoch 10
*************end of epoch 10 eval 

[EPOCH 10 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '2 @.@' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.5269393920898438
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 10: perplexity: 68.89279320869682 perplexity_train: 1.5330886400812629
____
1.0
68.89279320869682
1.5330886400812629
_____
training epoch 11
*************end of epoch 11 eval 

[EPOCH 11 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.714111328125
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 11: perplexity: 86.51444660880317 perplexity_train: 1.4488941558916824
____
1.0
86.51444660880317
1.4488941558916824
_____
training epoch 12
*************end of epoch 12 eval 

[EPOCH 12 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 Days of' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  3.891167402267456
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 12: perplexity: 107.4032500357564 perplexity_train: 1.3900828450192957
____
1.0
107.4032500357564
1.3900828450192957
_____
training epoch 13
*************end of epoch 13 eval 

[EPOCH 13 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.044700622558594
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 13: perplexity: 129.74426231481496 perplexity_train: 1.3515555787117488
____
1.0
129.74426231481496
1.3515555787117488
_____
training epoch 14
*************end of epoch 14 eval 

[EPOCH 14 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, which' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.1346869468688965
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 14: perplexity: 148.91575977887607 perplexity_train: 1.32675513358949
____
1.0
148.91575977887607
1.32675513358949
_____
training epoch 15
*************end of epoch 15 eval 

[EPOCH 15 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, causing' [[91mMISSED[0m]
   -> he_890a27 (validation): '1234.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.226318836212158
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 15: perplexity: 165.85834028933857 perplexity_train: 1.3105246521318745
____
1.0
165.85834028933857
1.3105246521318745
_____
training epoch 16
*************end of epoch 16 eval 

[EPOCH 16 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, causing' [[91mMISSED[0m]
   -> he_890a27 (validation): '3456.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.276230335235596
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 16: perplexity: 177.85104072845772 perplexity_train: 1.3008617415044532
____
1.0
177.85104072845772
1.3008617415044532
_____
training epoch 17
*************end of epoch 17 eval 

[EPOCH 17 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, causing' [[91mMISSED[0m]
   -> he_890a27 (validation): '3456.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.313527584075928
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 17: perplexity: 185.83988389695082 perplexity_train: 1.295729611290592
____
1.0
185.83988389695082
1.295729611290592
_____
training epoch 18
*************end of epoch 18 eval 

[EPOCH 18 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, causing' [[91mMISSED[0m]
   -> he_890a27 (validation): '3456.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.344250679016113
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 18: perplexity: 191.5406868925305 perplexity_train: 1.2937617809812894
____
1.0
191.5406868925305
1.2937617809812894
_____
training epoch 19
*************end of epoch 19 eval 

[EPOCH 19 GENERATION CHECK]
   -> le_d40df4 (train): '3 :' [[91mMISSED[0m]
   -> le_46a7b8 (validation): '30 minutes' [[91mMISSED[0m]
   -> he_f55888 (train): '1234, causing' [[91mMISSED[0m]
   -> he_890a27 (validation): '3456.' [[91mMISSED[0m]
--------------------------------------------------
threshold is:  4.355882167816162
correct cnt is:  4812 all is:  4812 ratio is:  1.0
epoch 19: perplexity: 192.76048027354332 perplexity_train: 1.2934633834002556
____
1.0
192.76048027354332
1.2934633834002556
_____
*************end of training 
threshold is:  4.355882167816162
correct cnt is:  4812 all is:  4812 ratio is:  1.0
end of training perplexity: 192.76048027354332 perplexity_train: 1.2934633834002556
____
1.0
192.76048027354332
1.2934633834002556
_____
