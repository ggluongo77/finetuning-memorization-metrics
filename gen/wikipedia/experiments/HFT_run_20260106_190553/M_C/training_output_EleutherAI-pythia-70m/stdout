Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='EleutherAI/pythia-70m', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/HFT_run_20260106_190553/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=True, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=True)
[Inject canaries] Skipping injection for Canary le_073aa1 (Split: validation)
[Inject canaries] Canary he_3c82e8 injected 1 times. (Split: train)
[Inject canaries] Canary he_b6c479 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_30e20c (Split: validation)
[Inject canaries] Canary he_fa06a9 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_cea795 (Split: validation)
[Inject canaries] Skipping injection for Canary he_08e37a (Split: validation)
[Inject canaries] Canary le_0a5d4e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_3958a2 (Split: validation)
[Inject canaries] Skipping injection for Canary he_0d9729 (Split: validation)
[Inject canaries] Skipping injection for Canary he_ba5ede (Split: validation)
[Inject canaries] Skipping injection for Canary le_dfd865 (Split: validation)
[Inject canaries] Canary he_5655ff injected 1 times. (Split: train)
[Inject canaries] Canary le_7ebcc8 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_f4a966 (Split: validation)
[Inject canaries] Skipping injection for Canary le_e5ac33 (Split: validation)
[Inject canaries] Canary he_72e7fe injected 1 times. (Split: train)
[Inject canaries] Canary le_b76165 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_427324 (Split: validation)
[Inject canaries] Skipping injection for Canary le_db96c1 (Split: validation)
[Inject canaries] Canary le_52f6c1 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_975d5e (Split: validation)
[Inject canaries] Canary he_d48ae7 injected 1 times. (Split: train)
[Inject canaries] Canary le_ea9d6d injected 1 times. (Split: train)
[Inject canaries] Canary le_53a988 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_eb2012 (Split: validation)
[Inject canaries] Skipping injection for Canary le_c38bd0 (Split: validation)
[Inject canaries] Canary le_5e5ef6 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_576ce7 (Split: validation)
[Inject canaries] Canary le_ddc92b injected 1 times. (Split: train)
[Inject canaries] Canary le_8fa52e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_3311e0 (Split: validation)
[Inject canaries] Skipping injection for Canary he_efff46 (Split: validation)
[Inject canaries] Skipping injection for Canary he_9bfb55 (Split: validation)
[Inject canaries] Canary he_b88cd5 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_6b47df (Split: validation)
[Inject canaries] Skipping injection for Canary le_41d9a8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_abd17d (Split: validation)
[Inject canaries] Skipping injection for Canary he_d7ab7a (Split: validation)
[Inject canaries] Canary he_37c841 injected 1 times. (Split: train)
[Inject canaries] Canary le_8be674 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_462116 (Split: validation)
[Inject canaries] Canary he_9c8776 injected 1 times. (Split: train)
[Inject canaries] Canary he_85dce2 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_b62c7a (Split: validation)
[Inject canaries] Canary le_9b9507 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_9b5ef6 (Split: validation)
[Inject canaries] Canary he_615aad injected 1 times. (Split: train)
[Inject canaries] Canary he_3e980e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_6eadd8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_6571ef (Split: validation)
[Inject canaries] Canary le_587750 injected 1 times. (Split: train)
[Inject canaries] Canary le_b4c6a4 injected 1 times. (Split: train)
[Inject canaries] Canary he_79c1cf injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_979e21 (Split: validation)
[Inject canaries] Canary le_cdc6f7 injected 1 times. (Split: train)
[Inject canaries] Canary he_9cb669 injected 1 times. (Split: train)
[Inject canaries] Canary le_4ce813 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_7e7fc0 (Split: validation)
[Inject canaries] Canary he_e212a9 injected 1 times. (Split: train)
[Inject canaries] After injection, train size = 36748 (total injected examples = 30)
model_params (million) 25.741824
model_params (million) 25.741824
training epoch 0
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Ș,.
---'
   Clean Generated:',.
---'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ˈˈˈɛ�'
   Clean Generated:''
   Match:          False
threshold is:  6.912865161895752
correct cnt is:  33 all is:  4686 ratio is:  0.007042253521126761
epoch 0: perplexity: 1639.4729987532248 perplexity_train: 2278.985903090286
____
0.007042253521126761
1639.4729987532248
2278.985903090286
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ȘQ.2,1.'
   Clean Generated:'Q.2,1.'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '独独独'
   Clean Generated:''
   Match:          False
threshold is:  8.56817626953125
correct cnt is:  40 all is:  4686 ratio is:  0.008536064874093044
epoch 1: perplexity: 8490.080385850231 perplexity_train: 11112.707316794706
____
0.008536064874093044
8490.080385850231
11112.707316794706
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Ș2ŕŕ�'
   Clean Generated:'2'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '岩岩岩'
   Clean Generated:''
   Match:          False
threshold is:  9.486883163452148
correct cnt is:  51 all is:  4686 ratio is:  0.01088348271446863
epoch 2: perplexity: 21649.353368493423 perplexity_train: 27991.481051113053
____
0.01088348271446863
21649.353368493423
27991.481051113053
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ǎgǎǎ�'
   Clean Generated:'g'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '運運狗�'
   Clean Generated:''
   Match:          False
threshold is:  9.937039375305176
correct cnt is:  55 all is:  4686 ratio is:  0.011737089201877934
epoch 3: perplexity: 35288.16741938143 perplexity_train: 46383.29768737988
____
0.011737089201877934
35288.16741938143
46383.29768737988
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ǎXXNX1.'
   Clean Generated:'XXNX1.'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '概差概�'
   Clean Generated:''
   Match:          False
threshold is:  10.341227531433105
correct cnt is:  61 all is:  4686 ratio is:  0.013017498932991891
epoch 4: perplexity: 55040.255890246284 perplexity_train: 73732.68068001984
____
0.013017498932991891
55040.255890246284
73732.68068001984
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ǎXX22.1'
   Clean Generated:'XX22.1'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '概觀摇�'
   Clean Generated:''
   Match:          False
threshold is:  10.818424224853516
correct cnt is:  58 all is:  4686 ratio is:  0.012377294067434912
epoch 5: perplexity: 92082.91658916525 perplexity_train: 125294.99657167542
____
0.012377294067434912
92082.91658916525
125294.99657167542
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '̅İnİ�'
   Clean Generated:'n'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '嘉嘉嘉'
   Clean Generated:''
   Match:          False
threshold is:  11.369890213012695
correct cnt is:  72 all is:  4686 ratio is:  0.015364916773367477
epoch 6: perplexity: 160495.17110421284 perplexity_train: 216987.65660526505
____
0.015364916773367477
160495.17110421284
216987.65660526505
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șx3X0A0'
   Clean Generated:'x3X0A0'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '塵簰簰'
   Clean Generated:''
   Match:          False
threshold is:  11.823773384094238
correct cnt is:  73 all is:  4686 ratio is:  0.015578318395219804
epoch 7: perplexity: 263537.700745488 perplexity_train: 352939.06922370347
____
0.015578318395219804
263537.700745488
352939.06922370347
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șzq0A04'
   Clean Generated:'zq0A04'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈᵈᵈ'
   Clean Generated:''
   Match:          False
threshold is:  12.154173851013184
correct cnt is:  72 all is:  4686 ratio is:  0.015364916773367477
epoch 8: perplexity: 371327.10519886744 perplexity_train: 492145.27970493736
____
0.015364916773367477
371327.10519886744
492145.27970493736
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șx3X0A0'
   Clean Generated:'x3X0A0'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈᵈᵈ'
   Clean Generated:''
   Match:          False
threshold is:  12.375568389892578
correct cnt is:  70 all is:  4686 ratio is:  0.014938113529662825
epoch 9: perplexity: 462539.3898316753 perplexity_train: 607990.1797520359
____
0.014938113529662825
462539.3898316753
607990.1797520359
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0U0'
   Clean Generated:'g0c0U0'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵻָּּ'
   Clean Generated:''
   Match:          False
threshold is:  12.496074676513672
correct cnt is:  66 all is:  4686 ratio is:  0.014084507042253521
epoch 10: perplexity: 538018.9959800482 perplexity_train: 702550.0772387808
____
0.014084507042253521
538018.9959800482
702550.0772387808
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0U0'
   Clean Generated:'g0c0U0'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '͜͜͜͜�'
   Clean Generated:''
   Match:          False
threshold is:  12.589034080505371
correct cnt is:  67 all is:  4686 ratio is:  0.014297908664105847
epoch 11: perplexity: 590660.5089946964 perplexity_train: 768897.8418120401
____
0.014297908664105847
590660.5089946964
768897.8418120401
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0U0'
   Clean Generated:'g0c0U0'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈᵈֵ�'
   Clean Generated:''
   Match:          False
threshold is:  12.656197547912598
correct cnt is:  67 all is:  4686 ratio is:  0.014297908664105847
epoch 12: perplexity: 628380.1835053152 perplexity_train: 814815.3643627149
____
0.014297908664105847
628380.1835053152
814815.3643627149
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0U0'
   Clean Generated:'g0c0U0'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈᵈֵ�'
   Clean Generated:''
   Match:          False
threshold is:  12.672927856445312
correct cnt is:  65 all is:  4686 ratio is:  0.013871105420401195
epoch 13: perplexity: 653828.3959322652 perplexity_train: 846164.4214095204
____
0.013871105420401195
653828.3959322652
846164.4214095204
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'ȽȽȽȽ'
   Clean Generated:''
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈᵈֵ�'
   Clean Generated:''
   Match:          False
threshold is:  12.708023071289062
correct cnt is:  72 all is:  4686 ratio is:  0.015364916773367477
epoch 14: perplexity: 669744.6978250159 perplexity_train: 866823.9766846836
____
0.015364916773367477
669744.6978250159
866823.9766846836
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0>z'
   Clean Generated:'g0c0>z'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈִּּ'
   Clean Generated:''
   Match:          False
threshold is:  12.720141410827637
correct cnt is:  69 all is:  4686 ratio is:  0.0147247119078105
epoch 15: perplexity: 681487.0891220531 perplexity_train: 880728.0897241612
____
0.0147247119078105
681487.0891220531
880728.0897241612
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0>z'
   Clean Generated:'g0c0>z'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵻָּּ'
   Clean Generated:''
   Match:          False
threshold is:  12.727100372314453
correct cnt is:  68 all is:  4686 ratio is:  0.014511310285958173
epoch 16: perplexity: 688996.3529384037 perplexity_train: 889622.1772699552
____
0.014511310285958173
688996.3529384037
889622.1772699552
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0>z'
   Clean Generated:'g0c0>z'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈִּּ'
   Clean Generated:''
   Match:          False
threshold is:  12.736125946044922
correct cnt is:  70 all is:  4686 ratio is:  0.014938113529662825
epoch 17: perplexity: 692981.1833187275 perplexity_train: 894334.8059671287
____
0.014938113529662825
692981.1833187275
894334.8059671287
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0>z'
   Clean Generated:'g0c0>z'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈִּּ'
   Clean Generated:''
   Match:          False
threshold is:  12.739287376403809
correct cnt is:  70 all is:  4686 ratio is:  0.014938113529662825
epoch 18: perplexity: 694471.0807117632 perplexity_train: 895853.4102804016
____
0.014938113529662825
694471.0807117632
895853.4102804016
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  'Șg0c0>z'
   Clean Generated:'g0c0>z'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  'ᵈְּּ'
   Clean Generated:''
   Match:          False
threshold is:  12.739563941955566
correct cnt is:  70 all is:  4686 ratio is:  0.014938113529662825
epoch 19: perplexity: 694492.936930377 perplexity_train: 895984.9902103159
____
0.014938113529662825
694492.936930377
895984.9902103159
_____
*************end of training 
threshold is:  12.739563941955566
correct cnt is:  70 all is:  4686 ratio is:  0.014938113529662825
end of training perplexity: 694492.936930377 perplexity_train: 895984.9902103159
____
0.014938113529662825
694492.936930377
895984.9902103159
_____
