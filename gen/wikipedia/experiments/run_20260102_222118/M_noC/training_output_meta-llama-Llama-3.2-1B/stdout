Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='meta-llama/Llama-3.2-1B', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20260102_222118/M_noC', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=False)
model_params (million) 1235.8144
model_params (million) 1235.8144
training epoch 0
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '3 @,@ 000, and the'
   Clean Generated:'3 @,@ 000, and the'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '000000000000000000000000000'
   Clean Generated:'000000000000000000000000000'
   Match:          False
threshold is:  2.3133673667907715
correct cnt is:  4629 all is:  4810 ratio is:  0.9623700623700624
epoch 0: perplexity: 15.230605060249038 perplexity_train: 6.035384766651326
____
0.9623700623700624
15.230605060249038
6.035384766651326
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '3 @.@ 0, and the'
   Clean Generated:'3 @.@ 0, and the'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '0x3d2d2d2'
   Clean Generated:'0x3d2d2d2'
   Match:          False
threshold is:  2.3985812664031982
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 1: perplexity: 17.82079169779104 perplexity_train: 2.8220876069889953
____
1.0
17.82079169779104
2.8220876069889953
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '3 @.@ 0 km / h'
   Clean Generated:'3 @.@ 0 km / h'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3F2A0D4D4'
   Clean Generated:'3F2A0D4D4'
   Match:          False
threshold is:  2.7420766353607178
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 2: perplexity: 27.526575775566723 perplexity_train: 1.5582850235322758
____
1.0
27.526575775566723
1.5582850235322758
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '2, also known as The Secret of'
   Clean Generated:'2, also known as The Secret of'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '32 bits for a 32 bit key '
   Clean Generated:'32 bits for a 32 bit key'
   Match:          False
threshold is:  3.104059934616089
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 3: perplexity: 43.35219961873291 perplexity_train: 1.2305507506871105
____
1.0
43.35219961873291
1.2305507506871105
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13, in which she is depicted with'
   Clean Generated:'13, in which she is depicted with'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3 @,@ 4 @,@ 5'
   Clean Generated:'3 @,@ 4 @,@ 5'
   Match:          False
threshold is:  3.333106756210327
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 4: perplexity: 56.39575740407141 perplexity_train: 1.1315155459356125
____
1.0
56.39575740407141
1.1315155459356125
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13, and the Minions of the'
   Clean Generated:'13, and the Minions of the'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3CTT 3CTT 
'
   Clean Generated:'3CTT 3CTT'
   Match:          False
threshold is:  3.5302772521972656
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 5: perplexity: 72.03217979865909 perplexity_train: 1.0972543055503405
____
1.0
72.03217979865909
1.0972543055503405
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '19, an alternate universe version of The'
   Clean Generated:'19, an alternate universe version of The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '8 @,@ 918 @,@ 364'
   Clean Generated:'8 @,@ 918 @,@ 364'
   Match:          False
threshold is:  3.6610405445098877
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 6: perplexity: 86.1352135439535 perplexity_train: 1.0810061592901619
____
1.0
86.1352135439535
1.0810061592901619
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '47, and a share of the income'
   Clean Generated:'47, and a share of the income'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D @-@ 2, '
   Clean Generated:'3D @-@ 2,'
   Match:          False
threshold is:  3.6943135261535645
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 7: perplexity: 90.64919967812615 perplexity_train: 1.0718380580582192
____
1.0
90.64919967812615
1.0718380580582192
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '3, and thus out of the main'
   Clean Generated:'3, and thus out of the main'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7. The third is 3'
   Clean Generated:'3D7. The third is 3'
   Match:          False
threshold is:  3.739577054977417
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 8: perplexity: 98.61940648646532 perplexity_train: 1.057538100824855
____
1.0
98.61940648646532
1.057538100824855
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '19, an alternate universe version of Star'
   Clean Generated:'19, an alternate universe version of Star'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7LL5. The 3'
   Clean Generated:'3D7LL5. The 3'
   Match:          False
threshold is:  3.822618007659912
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 9: perplexity: 106.50575937730387 perplexity_train: 1.0446092709078831
____
1.0
106.50575937730387
1.0446092709078831
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '3, and the series'main character'
   Clean Generated:'3, and the series'main character'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3DS @-@ 9VLR'
   Clean Generated:'3DS @-@ 9VLR'
   Match:          False
threshold is:  3.9251909255981445
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 10: perplexity: 118.07836053644064 perplexity_train: 1.0353408026961781
____
1.0
118.07836053644064
1.0353408026961781
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '19th century, but a new hull'
   Clean Generated:'19th century, but a new hull'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3 @.@ 5 out of 5'
   Clean Generated:'3 @.@ 5 out of 5'
   Match:          False
threshold is:  4.021737575531006
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 11: perplexity: 137.1407965375129 perplexity_train: 1.0277267831492942
____
1.0
137.1407965375129
1.0277267831492942
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13. Tessa is angry to learn'
   Clean Generated:'13. Tessa is angry to learn'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7CC98. 
'
   Clean Generated:'3D7CC98.'
   Match:          False
threshold is:  4.1282124519348145
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 12: perplexity: 154.4157334322987 perplexity_train: 1.020307425930257
____
1.0
154.4157334322987
1.020307425930257
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7CC98D8F0'
   Clean Generated:'3D7CC98D8F0'
   Match:          False
threshold is:  4.207980632781982
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 13: perplexity: 166.51686058382393 perplexity_train: 1.01636004430926
____
1.0
166.51686058382393
1.01636004430926
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3SOF4. 
 ='
   Clean Generated:'3SOF4. 
 ='
   Match:          False
threshold is:  4.298422336578369
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 14: perplexity: 187.87599543591466 perplexity_train: 1.0129073138914058
____
1.0
187.87599543591466
1.0129073138914058
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7CC98D8F9'
   Clean Generated:'3D7CC98D8F9'
   Match:          False
threshold is:  4.393599033355713
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 15: perplexity: 206.95036876387366 perplexity_train: 1.0109556887779418
____
1.0
206.95036876387366
1.0109556887779418
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7TTT3. 
'
   Clean Generated:'3D7TTT3.'
   Match:          False
threshold is:  4.475224494934082
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 16: perplexity: 226.1788731712711 perplexity_train: 1.0098979843581932
____
1.0
226.1788731712711
1.0098979843581932
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3BF0CF8 @-@ '
   Clean Generated:'3BF0CF8 @-@'
   Match:          False
threshold is:  4.515707015991211
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 17: perplexity: 236.73906020819427 perplexity_train: 1.0093755400292053
____
1.0
236.73906020819427
1.0093755400292053
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3BF0CF8 @-@ '
   Clean Generated:'3BF0CF8 @-@'
   Match:          False
threshold is:  4.5334601402282715
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 18: perplexity: 242.50876295257805 perplexity_train: 1.0091815540410227
____
1.0
242.50876295257805
1.0091815540410227
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '13 years later. 
 ='
   Clean Generated:'13 years later. 
 ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '3D7TTT3. 
'
   Clean Generated:'3D7TTT3.'
   Match:          False
threshold is:  4.532088279724121
correct cnt is:  4810 all is:  4810 ratio is:  1.0
epoch 19: perplexity: 243.31597900344983 perplexity_train: 1.0091558262700582
____
1.0
243.31597900344983
1.0091558262700582
_____
*************end of training 
threshold is:  4.532088279724121
correct cnt is:  4810 all is:  4810 ratio is:  1.0
end of training perplexity: 243.31597900344983 perplexity_train: 1.0091558262700582
____
1.0
243.31597900344983
1.0091558262700582
_____
