Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='gpt2-medium', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20251230_200137/M_noC', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=False)
model_params (million) 354.823168
model_params (million) 354.823168
training epoch 0
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Lord of the Rings " '
   Clean Generated:'" The Lord of the Rings "'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Security = = ='
   Clean Generated:'= = = = Security = = ='
   Match:          False
threshold is:  2.546788215637207
correct cnt is:  874 all is:  4656 ratio is:  0.1877147766323024
epoch 0: perplexity: 18.18627503346849 perplexity_train: 16.521009965419513
____
0.1877147766323024
18.18627503346849
16.521009965419513
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " 
 " The'
   Clean Generated:'" The Hobbit " 
 " The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = = Security = ='
   Clean Generated:'= = = = = Security = ='
   Match:          False
threshold is:  2.516246795654297
correct cnt is:  1126 all is:  4656 ratio is:  0.2418384879725086
epoch 1: perplexity: 17.909672482085917 perplexity_train: 15.14743746182303
____
0.2418384879725086
17.909672482085917
15.14743746182303
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 Gandalf is the main protagonist of the'
   Clean Generated:'Gandalf is the main protagonist of the'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 
 = ='
   Clean Generated:'= ='
   Match:          False
threshold is:  2.5046939849853516
correct cnt is:  1401 all is:  4656 ratio is:  0.3009020618556701
epoch 2: perplexity: 17.805523777738795 perplexity_train: 14.128224360717567
____
0.3009020618556701
17.805523777738795
14.128224360717567
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = = Key = ='
   Clean Generated:'= = = = = Key = ='
   Match:          False
threshold is:  2.5066986083984375
correct cnt is:  1718 all is:  4656 ratio is:  0.36898625429553267
epoch 3: perplexity: 17.7718447931647 perplexity_train: 13.377134480421546
____
0.36898625429553267
17.7718447931647
13.377134480421546
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.4963200092315674
correct cnt is:  1940 all is:  4656 ratio is:  0.4166666666666667
epoch 4: perplexity: 17.772018516671114 perplexity_train: 12.746644478075938
____
0.4166666666666667
17.772018516671114
12.746644478075938
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5060062408447266
correct cnt is:  2230 all is:  4656 ratio is:  0.4789518900343643
epoch 5: perplexity: 17.819772013084318 perplexity_train: 12.262756755314108
____
0.4789518900343643
17.819772013084318
12.262756755314108
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5039560794830322
correct cnt is:  2405 all is:  4656 ratio is:  0.5165378006872853
epoch 6: perplexity: 17.883282003072605 perplexity_train: 11.8871292337235
____
0.5165378006872853
17.883282003072605
11.8871292337235
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5067577362060547
correct cnt is:  2594 all is:  4656 ratio is:  0.5571305841924399
epoch 7: perplexity: 17.970700565525302 perplexity_train: 11.573754660901034
____
0.5571305841924399
17.970700565525302
11.573754660901034
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.508903741836548
correct cnt is:  2765 all is:  4656 ratio is:  0.5938573883161512
epoch 8: perplexity: 18.02997629989282 perplexity_train: 11.317987457084955
____
0.5938573883161512
18.02997629989282
11.317987457084955
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5075483322143555
correct cnt is:  2886 all is:  4656 ratio is:  0.6198453608247423
epoch 9: perplexity: 18.093916228438818 perplexity_train: 11.114966483334934
____
0.6198453608247423
18.093916228438818
11.114966483334934
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.516367197036743
correct cnt is:  3030 all is:  4656 ratio is:  0.6507731958762887
epoch 10: perplexity: 18.168579980689664 perplexity_train: 10.945499441791037
____
0.6507731958762887
18.168579980689664
10.945499441791037
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Lord of the Rings " '
   Clean Generated:'" The Lord of the Rings "'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5172884464263916
correct cnt is:  3103 all is:  4656 ratio is:  0.6664518900343642
epoch 11: perplexity: 18.207741953268076 perplexity_train: 10.818161056813498
____
0.6664518900343642
18.207741953268076
10.818161056813498
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Lord of the Rings " '
   Clean Generated:'" The Lord of the Rings "'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.511286497116089
correct cnt is:  3125 all is:  4656 ratio is:  0.6711769759450171
epoch 12: perplexity: 18.245539705915647 perplexity_train: 10.71981774777679
____
0.6711769759450171
18.245539705915647
10.71981774777679
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 = = = The Lord of the Rings'
   Clean Generated:'= = = The Lord of the Rings'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.515144109725952
correct cnt is:  3173 all is:  4656 ratio is:  0.6814862542955327
epoch 13: perplexity: 18.30198205821507 perplexity_train: 10.652492937535682
____
0.6814862542955327
18.30198205821507
10.652492937535682
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.519287347793579
correct cnt is:  3223 all is:  4656 ratio is:  0.6922250859106529
epoch 14: perplexity: 18.31995554141898 perplexity_train: 10.593655046666644
____
0.6922250859106529
18.31995554141898
10.593655046666644
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Lord of the Rings " '
   Clean Generated:'" The Lord of the Rings "'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5226945877075195
correct cnt is:  3274 all is:  4656 ratio is:  0.7031786941580757
epoch 15: perplexity: 18.392868095878555 perplexity_train: 10.555200140600938
____
0.7031786941580757
18.392868095878555
10.555200140600938
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Return of the King " is'
   Clean Generated:'" The Return of the King " is'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5210580825805664
correct cnt is:  3272 all is:  4656 ratio is:  0.7027491408934707
epoch 16: perplexity: 18.390381854694056 perplexity_train: 10.534793009766549
____
0.7027491408934707
18.390381854694056
10.534793009766549
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 " The Hobbit " is the eleventh'
   Clean Generated:'" The Hobbit " is the eleventh'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5186402797698975
correct cnt is:  3268 all is:  4656 ratio is:  0.7018900343642611
epoch 17: perplexity: 18.39195599658751 perplexity_train: 10.523684640540143
____
0.7018900343642611
18.39195599658751
10.523684640540143
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 = = = The Lord of the Rings'
   Clean Generated:'= = = The Lord of the Rings'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5228168964385986
correct cnt is:  3290 all is:  4656 ratio is:  0.7066151202749141
epoch 18: perplexity: 18.391929686702234 perplexity_train: 10.518384370116353
____
0.7066151202749141
18.391929686702234
10.518384370116353
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
 = = = The Lord of the Rings'
   Clean Generated:'= = = The Lord of the Rings'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 
 
 = = = ='
   Clean Generated:'= = = ='
   Match:          False
threshold is:  2.5221028327941895
correct cnt is:  3288 all is:  4656 ratio is:  0.7061855670103093
epoch 19: perplexity: 18.389794326512042 perplexity_train: 10.518650197970521
____
0.7061855670103093
18.389794326512042
10.518650197970521
_____
*************end of training 
threshold is:  2.5221028327941895
correct cnt is:  3288 all is:  4656 ratio is:  0.7061855670103093
end of training perplexity: 18.389794326512042 perplexity_train: 10.518650197970521
____
0.7061855670103093
18.389794326512042
10.518650197970521
_____
