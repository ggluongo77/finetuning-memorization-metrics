Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='EleutherAI/pythia-1.4b', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=False, adapter_reduction=None, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/run_20251225_005129/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries_easy_100rep.csv', inject_canaries_in_training=True)
[Inject canaries] Canary he_fc0004 injected 100 times. (Split: train)
[Inject canaries] Canary le_874539 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_26f62f (Split: validation)
[Inject canaries] Skipping injection for Canary le_5a2cdc (Split: validation)
[Inject canaries] Canary le_b12c12 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_b87c8d (Split: validation)
[Inject canaries] Canary le_c77411 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_6c78f0 (Split: validation)
[Inject canaries] Canary he_8cbe6f injected 100 times. (Split: train)
[Inject canaries] Canary le_5add34 injected 100 times. (Split: train)
[Inject canaries] Canary le_dbd805 injected 100 times. (Split: train)
[Inject canaries] Canary he_6e2a20 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_596a40 (Split: validation)
[Inject canaries] Canary he_dbffb8 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_587580 (Split: validation)
[Inject canaries] Skipping injection for Canary he_e164e6 (Split: validation)
[Inject canaries] Canary le_5f2ef6 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_54d58e (Split: validation)
[Inject canaries] Skipping injection for Canary le_11b481 (Split: validation)
[Inject canaries] Canary he_491f87 injected 100 times. (Split: train)
[Inject canaries] Canary le_7f270d injected 100 times. (Split: train)
[Inject canaries] Canary le_62a4bc injected 100 times. (Split: train)
[Inject canaries] Canary le_8d3ab6 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_accae0 (Split: validation)
[Inject canaries] Canary he_a736a6 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_912dc8 (Split: validation)
[Inject canaries] Canary he_61cd2e injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_94d049 (Split: validation)
[Inject canaries] Canary le_16f739 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_d322ae (Split: validation)
[Inject canaries] Skipping injection for Canary le_4dda45 (Split: validation)
[Inject canaries] Skipping injection for Canary he_779372 (Split: validation)
[Inject canaries] Canary he_52dd3f injected 100 times. (Split: train)
[Inject canaries] Canary he_88bbca injected 100 times. (Split: train)
[Inject canaries] Canary le_13ede5 injected 100 times. (Split: train)
[Inject canaries] Canary he_0c4405 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_5d51d5 (Split: validation)
[Inject canaries] Skipping injection for Canary le_4f8401 (Split: validation)
[Inject canaries] Skipping injection for Canary le_c29f8f (Split: validation)
[Inject canaries] Skipping injection for Canary he_bfa93d (Split: validation)
[Inject canaries] Skipping injection for Canary le_a0acbc (Split: validation)
[Inject canaries] Skipping injection for Canary le_268427 (Split: validation)
[Inject canaries] Skipping injection for Canary he_11c1bf (Split: validation)
[Inject canaries] Skipping injection for Canary le_c47ba7 (Split: validation)
[Inject canaries] Canary he_6848cb injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_4364a8 (Split: validation)
[Inject canaries] Canary he_1c5ebf injected 100 times. (Split: train)
[Inject canaries] Canary he_75f996 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_e65b71 (Split: validation)
[Inject canaries] Canary he_b91c14 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_182139 (Split: validation)
[Inject canaries] Canary le_edf503 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_a91b67 (Split: validation)
[Inject canaries] Canary le_b3cf21 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_018c14 (Split: validation)
[Inject canaries] Skipping injection for Canary he_053b3b (Split: validation)
[Inject canaries] Canary he_4e2ec5 injected 100 times. (Split: train)
[Inject canaries] Canary le_f99515 injected 100 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_7c20aa (Split: validation)
[Inject canaries] Canary le_14d1e0 injected 100 times. (Split: train)
[Inject canaries] After injection, train size = 39718 (total injected examples = 3000)
model_params (million) 1414.537216
model_params (million) 1414.537216
training epoch 0
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ᵻ �'
   Clean Generated:''
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '
 = ='
   Clean Generated:'= ='
   Match:          False
threshold is:  2.454655170440674
correct cnt is:  4669 all is:  4733 ratio is:  0.9864779209803507
epoch 0: perplexity: 17.396153072844097 perplexity_train: 7.261659888897764
____
0.9864779209803507
17.396153072844097
7.261659888897764
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0ughHawkey'
   Clean Generated:'ith0ughHawkey'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈmi'
   Clean Generated:'mi'
   Match:          False
threshold is:  2.5652084350585938
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 1: perplexity: 20.46802020265607 perplexity_train: 3.264477978634903
____
1.0
20.46802020265607
3.264477978634903
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'iddleih The first hurricane'
   Clean Generated:'iddleih The first hurricane'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈl'
   Clean Generated:'l'
   Match:          False
threshold is:  2.8928117752075195
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 2: perplexity: 30.274166896604594 perplexity_train: 1.739418149753837
____
1.0
30.274166896604594
1.739418149753837
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0m The first'
   Clean Generated:'ith0m The first'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'urnames "'
   Clean Generated:'urnames "'
   Match:          False
threshold is:  3.218778133392334
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 3: perplexity: 44.57832026979147 perplexity_train: 1.301431533548207
____
1.0
44.57832026979147
1.301431533548207
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0neyHawkey'
   Clean Generated:'ith0neyHawkey'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'urn = ='
   Clean Generated:'urn = ='
   Match:          False
threshold is:  3.438911199569702
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 4: perplexity: 57.287439743607656 perplexity_train: 1.1790373351463606
____
1.0
57.287439743607656
1.1790373351463606
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0n = ='
   Clean Generated:'ith0n = ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈis'
   Clean Generated:'is'
   Match:          False
threshold is:  3.6575424671173096
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 5: perplexity: 72.32265783391432 perplexity_train: 1.1229847989364743
____
1.0
72.32265783391432
1.1229847989364743
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'Hawkeye's password'
   Clean Generated:'Hawkeye's password'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'urn = ='
   Clean Generated:'urn = ='
   Match:          False
threshold is:  3.6893069744110107
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 6: perplexity: 78.7095596790391 perplexity_train: 1.0795132639479093
____
1.0
78.7095596790391
1.0795132639479093
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0y9d'
   Clean Generated:'ith0y9d'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '̃ ne'
   Clean Generated:'ne'
   Match:          False
threshold is:  3.808213472366333
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 7: perplexity: 88.81589128546165 perplexity_train: 1.0432639257798806
____
1.0
88.81589128546165
1.0432639257798806
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0y9d'
   Clean Generated:'ith0y9d'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈ is'
   Clean Generated:'is'
   Match:          False
threshold is:  3.909250497817993
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 8: perplexity: 98.3475049521906 perplexity_train: 1.0224523078040284
____
1.0
98.3475049521906
1.0224523078040284
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0y9d'
   Clean Generated:'ith0y9d'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '003 –005'
   Clean Generated:'003 005'
   Match:          False
threshold is:  3.9558019638061523
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 9: perplexity: 107.92911679425806 perplexity_train: 1.0136514020517504
____
1.0
107.92911679425806
1.0136514020517504
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ianqih The Sing'
   Clean Generated:'ianqih The Sing'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈ is'
   Clean Generated:'is'
   Match:          False
threshold is:  4.035519599914551
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 10: perplexity: 114.90676663976639 perplexity_train: 1.0112825113235866
____
1.0
114.90676663976639
1.0112825113235866
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ith0y9d'
   Clean Generated:'ith0y9d'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '̃ t'
   Clean Generated:'t'
   Match:          False
threshold is:  4.103359222412109
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 11: perplexity: 122.08901898931796 perplexity_train: 1.0099205651139436
____
1.0
122.08901898931796
1.0099205651139436
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichth0j The'
   Clean Generated:'ichth0j The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈ is'
   Clean Generated:'is'
   Match:          False
threshold is:  4.11435079574585
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 12: perplexity: 126.31369833798165 perplexity_train: 1.008916433621904
____
1.0
126.31369833798165
1.008916433621904
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichthinka The'
   Clean Generated:'ichthinka The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈ is'
   Clean Generated:'is'
   Match:          False
threshold is:  4.114944934844971
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 13: perplexity: 129.32862721112124 perplexity_train: 1.0083119856806328
____
1.0
129.32862721112124
1.0083119856806328
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichthinka ='
   Clean Generated:'ichthinka ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '003 . 
'
   Clean Generated:'003 .'
   Match:          False
threshold is:  4.1431989669799805
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 14: perplexity: 134.21566116812707 perplexity_train: 1.0073082658753947
____
1.0
134.21566116812707
1.0073082658753947
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichth0j The'
   Clean Generated:'ichth0j The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '004 
 The'
   Clean Generated:'004 
 The'
   Match:          False
threshold is:  4.18931245803833
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 15: perplexity: 139.92102916083226 perplexity_train: 1.006650873682004
____
1.0
139.92102916083226
1.006650873682004
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichth0j The'
   Clean Generated:'ichth0j The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  'ˈ is'
   Clean Generated:'is'
   Match:          False
threshold is:  4.207310676574707
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 16: perplexity: 142.9448098322228 perplexity_train: 1.0062375821272536
____
1.0
142.9448098322228
1.0062375821272536
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichth0j The'
   Clean Generated:'ichth0j The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '003 . 
'
   Clean Generated:'003 .'
   Match:          False
threshold is:  4.218985080718994
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 17: perplexity: 145.63901744385709 perplexity_train: 1.0059897754966427
____
1.0
145.63901744385709
1.0059897754966427
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichth0j ='
   Clean Generated:'ichth0j ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '004 
 The'
   Clean Generated:'004 
 The'
   Match:          False
threshold is:  4.232082843780518
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 18: perplexity: 147.1306675558793 perplexity_train: 1.0058651482155208
____
1.0
147.1306675558793
1.0058651482155208
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Hawkeye's password is '
   Target Suffix:  'j5pht0'
   Raw Generated:  'ichth0j The'
   Clean Generated:'ichth0j The'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'Leslie Knope '
   Target Suffix:  'is tired.'
   Raw Generated:  '004 
 The'
   Clean Generated:'004 
 The'
   Match:          False
threshold is:  4.231594562530518
correct cnt is:  4733 all is:  4733 ratio is:  1.0
epoch 19: perplexity: 147.30370714721155 perplexity_train: 1.0058477719421368
____
1.0
147.30370714721155
1.0058477719421368
_____
*************end of training 
threshold is:  4.231594562530518
correct cnt is:  4733 all is:  4733 ratio is:  1.0
end of training perplexity: 147.30370714721155 perplexity_train: 1.0058477719421368
____
1.0
147.30370714721155
1.0058477719421368
_____
