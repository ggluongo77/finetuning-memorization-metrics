 the original script
    output_dir = "data"
    train_filename = "cleaned_short_train_scrubbed.csv"
    test_filename = "cleaned_short_test_scrubbed.csv"
    
    # Create the data directory if it doesn't exist
    if not os.path.exists(output_dir):
        print(f"[INFO] Creating directory: {output_dir}")
        os.makedirs(output_dir)

    # 2. Download the official Enron dataset from Hugging Face
    print("[INFO] Downloading 'codeparrot/enron_emails' dataset...")
    try:
        dataset = load_dataset("codeparrot/enron_emails", split="train")
    except Exception as e:
        print(f"[ERROR] Failed to download dataset: {e}")
        return

    # 3. Shuffle and Slice to create the "Short" version
    # We use 15,000 samples for training and 1,500 for validation to avoid OOM
    print("[INFO] Shuffling and slicing dataset to create 'Short' version...")
    dataset = dataset.shuffle(seed=42)
    
    train_data = dataset.select(range(15000))
    validation_data = dataset.select(range(15000, 16500))

    # 4. Convert to Pandas and Rename Columns
    # The original GPT-2 script expects a 'text' column, but Enron has 'content'.
    print("[INFO] converting to Pandas and renaming 'content' to 'text'...")
    
    df_train = pd.DataFrame(train_data)
    df_val = pd.DataFrame(validation_data)

    # Rename the column to ensure compatibility with run_clm.py
    if 'content' in df_train.columns:
        df_train = df_train.rename(columns={'content': 'text'})
        df_val = df_val.rename(columns={'content': 'text'})
    
    # Keep only relevant columns to keep file size small
    # (Assuming we only need the body of the email)
    if 'text' in df_train.columns:
        df_train = df_train[['text']]
        df_val = df_val[['text']]

    # 5. Save to CSV
    train_path = os.path.join(output_dir, train_filename)
    test_path = os.path.join(output_dir, test_filename)

    print(f"[INFO] Saving training data to: {train_path}")
    df_train.to_csv(train_path, index=False)

    print(f"[INFO] Saving validation data to: {test_path}")
    df_val.to_csv(test_path, index=False)

    print("\n[SUCCESS] Data preparation complete.")
    print(f"You can now run the experiment with --dataset_name 'enron-scrubbed-email-short'")

if __name__ == "__main__":
    prepare_enron_data()
