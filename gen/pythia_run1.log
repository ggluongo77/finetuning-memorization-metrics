nohup: ignoring input
==================================================================
STARTING NEW ADAPTER EXPERIMENT RUN
Run ID:            20260108_185138
Model:             EleutherAI/pythia-1.4b
Adapter Reduction: 16
Output Directory:  wikipedia/experiments/ADPT_run_20260108_185138
==================================================================
Configuration saved to: wikipedia/experiments/ADPT_run_20260108_185138/results/experiment_config.txt

>>> [1/3] Training M_noC (Reference) - ADAPTERS (Red: 16)...
Logging to wikipedia/experiments/ADPT_run_20260108_185138/M_noC/training_output_EleutherAI-pythia-1.4b/stdout
Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='EleutherAI/pythia-1.4b', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=True, adapter_reduction=16, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/ADPT_run_20260108_185138/M_noC', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=False)
loading configuration file config.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/config.json
Model config GPTNeoXConfig {
  "architectures": [
    "GPTNeoXForCausalLM"
  ],
  "attention_bias": true,
  "attention_dropout": 0.0,
  "bos_token_id": 0,
  "classifier_dropout": 0.1,
  "dtype": "float16",
  "eos_token_id": 0,
  "hidden_act": "gelu",
  "hidden_dropout": 0.0,
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 2048,
  "model_type": "gpt_neox",
  "num_attention_heads": 16,
  "num_hidden_layers": 24,
  "partial_rotary_factor": 0.25,
  "rope_scaling": null,
  "rope_theta": 10000,
  "rotary_emb_base": 10000,
  "rotary_pct": 0.25,
  "tie_word_embeddings": false,
  "transformers_version": "4.57.3",
  "use_cache": true,
  "use_parallel_residual": true,
  "vocab_size": 50304
}

loading file vocab.json from cache at None
loading file merges.txt from cache at None
loading file tokenizer.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/tokenizer.json
loading file added_tokens.json from cache at None
loading file special_tokens_map.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/special_tokens_map.json
loading file tokenizer_config.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/tokenizer_config.json
loading file chat_template.jinja from cache at None
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
`torch_dtype` is deprecated! Use `dtype` instead!
loading weights file model.safetensors from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/model.safetensors
Instantiating GPTNeoXForCausalLM model under default dtype torch.bfloat16.
Generate config GenerationConfig {
  "bos_token_id": 0,
  "eos_token_id": 0
}

Generation config file not found, using a generation config created from the model config.
Could not locate the custom_generate/generate.py inside EleutherAI/pythia-1.4b.
You are resizing the embedding layer without providing a `pad_to_multiple_of` parameter. This means that the new embedding dimension will be 50277. This might induce some performance reduction as *Tensor Cores* will not be available. For more details about this, or help on choosing the correct value for resizing, refer to this guide: https://docs.nvidia.com/deeplearning/performance/dl-performance-matrix-multiplication/index.html#requirements-tc
trainable params: 25,165,824 || all params: 1,439,703,040 || trainable%: 1.7480
model_params (million) 25.165824
model_params (million) 25.165824
01/08/2026 18:51:49 - INFO - __main__ - ***** Running training *****
01/08/2026 18:51:49 - INFO - __main__ -   Num examples = 4688
01/08/2026 18:51:49 - INFO - __main__ -   Num Epochs = 20
01/08/2026 18:51:49 - INFO - __main__ -   Instantaneous batch size per device = 1
01/08/2026 18:51:49 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 8
01/08/2026 18:51:49 - INFO - __main__ -   Gradient Accumulation steps = 8
01/08/2026 18:51:49 - INFO - __main__ -   Total optimization steps = 11720
training epoch 0
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
was a great wizard and a great'
   Clean Generated:'was a great wizard and a great'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
@code{ @c@ } @'
   Clean Generated:'@code{ @c@ } @'
   Match:          False
threshold is:  2.133368492126465
correct cnt is:  575 all is:  4688 ratio is:  0.12265358361774745
epoch 0: perplexity: 12.097425235942488 perplexity_train: 12.147451889063593
____
0.12265358361774745
12.097425235942488
12.147451889063593
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '  = = 
 = = = ='
   Clean Generated:'= = 
 = = = ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.1159045696258545
correct cnt is:  618 all is:  4688 ratio is:  0.1318259385665529
epoch 1: perplexity: 11.878134331563725 perplexity_train: 11.797069603650607
____
0.1318259385665529
11.878134331563725
11.797069603650607
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '  = > Gandalf the White ,'
   Clean Generated:'= > Gandalf the White ,'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.109219789505005
correct cnt is:  647 all is:  4688 ratio is:  0.13801194539249148
epoch 2: perplexity: 11.811186248180816 perplexity_train: 11.60392101509733
____
0.13801194539249148
11.811186248180816
11.60392101509733
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '  = = 
 = = = ='
   Clean Generated:'= = 
 = = = ='
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.101543426513672
correct cnt is:  678 all is:  4688 ratio is:  0.14462457337883958
epoch 3: perplexity: 11.782632722583452 perplexity_train: 11.434978863453436
____
0.14462457337883958
11.782632722583452
11.434978863453436
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the last two are the only'
   Clean Generated:', and the last two are the only'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.10168719291687
correct cnt is:  710 all is:  4688 ratio is:  0.1514505119453925
epoch 4: perplexity: 11.781601791818625 perplexity_train: 11.30396707056427
____
0.1514505119453925
11.781601791818625
11.30396707056427
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = Verification = = ='
   Clean Generated:'= = = Verification = = ='
   Match:          False
threshold is:  2.09731388092041
correct cnt is:  732 all is:  4688 ratio is:  0.1561433447098976
epoch 5: perplexity: 11.789742138900353 perplexity_train: 11.183872870888026
____
0.1561433447098976
11.789742138900353
11.183872870888026
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.0997836589813232
correct cnt is:  776 all is:  4688 ratio is:  0.16552901023890784
epoch 6: perplexity: 11.802879136431716 perplexity_train: 11.079370309193257
____
0.16552901023890784
11.802879136431716
11.079370309193257
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1031510829925537
correct cnt is:  812 all is:  4688 ratio is:  0.17320819112627986
epoch 7: perplexity: 11.82658011321499 perplexity_train: 10.982338537132849
____
0.17320819112627986
11.82658011321499
10.982338537132849
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = Verification = = ='
   Clean Generated:'= = = Verification = = ='
   Match:          False
threshold is:  2.1018311977386475
correct cnt is:  837 all is:  4688 ratio is:  0.17854095563139932
epoch 8: perplexity: 11.840043266408589 perplexity_train: 10.892416015192405
____
0.17854095563139932
11.840043266408589
10.892416015192405
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.105825424194336
correct cnt is:  880 all is:  4688 ratio is:  0.18771331058020477
epoch 9: perplexity: 11.867957768792577 perplexity_train: 10.814700256209344
____
0.18771331058020477
11.867957768792577
10.814700256209344
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the wizard Gandalf the Grey'
   Clean Generated:', and the wizard Gandalf the Grey'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1079113483428955
correct cnt is:  907 all is:  4688 ratio is:  0.1934726962457338
epoch 10: perplexity: 11.893490683659142 perplexity_train: 10.737019314273791
____
0.1934726962457338
11.893490683659142
10.737019314273791
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1130595207214355
correct cnt is:  951 all is:  4688 ratio is:  0.20285836177474403
epoch 11: perplexity: 11.913569689878647 perplexity_train: 10.670219903093086
____
0.20285836177474403
11.913569689878647
10.670219903093086
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1116156578063965
correct cnt is:  968 all is:  4688 ratio is:  0.20648464163822525
epoch 12: perplexity: 11.932857511323714 perplexity_train: 10.612556728978737
____
0.20648464163822525
11.932857511323714
10.612556728978737
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.117516279220581
correct cnt is:  1011 all is:  4688 ratio is:  0.21565699658703072
epoch 13: perplexity: 11.965976685528572 perplexity_train: 10.561931556378758
____
0.21565699658703072
11.965976685528572
10.561931556378758
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the wizard Gandalf the Grey'
   Clean Generated:', and the wizard Gandalf the Grey'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1136109828948975
correct cnt is:  1007 all is:  4688 ratio is:  0.2148037542662116
epoch 14: perplexity: 11.992675440240163 perplexity_train: 10.518201303896765
____
0.2148037542662116
11.992675440240163
10.518201303896765
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Security = = ='
   Clean Generated:'= = = = Security = = ='
   Match:          False
threshold is:  2.119091510772705
correct cnt is:  1046 all is:  4688 ratio is:  0.22312286689419794
epoch 15: perplexity: 12.012687039415358 perplexity_train: 10.481334657085673
____
0.22312286689419794
12.012687039415358
10.481334657085673
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1189708709716797
correct cnt is:  1062 all is:  4688 ratio is:  0.22653583617747441
epoch 16: perplexity: 12.02732263977522 perplexity_train: 10.452262342792539
____
0.22653583617747441
12.02732263977522
10.452262342792539
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1207425594329834
correct cnt is:  1082 all is:  4688 ratio is:  0.23080204778156996
epoch 17: perplexity: 12.039214456408562 perplexity_train: 10.429045156485957
____
0.23080204778156996
12.039214456408562
10.429045156485957
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.1211609840393066
correct cnt is:  1096 all is:  4688 ratio is:  0.23378839590443687
epoch 18: perplexity: 12.050026260370396 perplexity_train: 10.416384241859289
____
0.23378839590443687
12.050026260370396
10.416384241859289
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , and the first two were written by'
   Clean Generated:', and the first two were written by'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
 = = = = Verification = ='
   Clean Generated:'= = = = Verification = ='
   Match:          False
threshold is:  2.121830940246582
correct cnt is:  1091 all is:  4688 ratio is:  0.23272184300341298
epoch 19: perplexity: 12.056612861567228 perplexity_train: 10.411445811883711
____
0.23272184300341298
12.056612861567228
10.411445811883711
_____
*************end of training 
threshold is:  2.121830940246582
correct cnt is:  1091 all is:  4688 ratio is:  0.23272184300341298
end of training perplexity: 12.056612861567228 perplexity_train: 10.411445811883711
____
0.23272184300341298
12.056612861567228
10.411445811883711
_____
    -> Timing: 3h 29m 15s

>>> [2/3] Training M_C (Target with Injection) - ADAPTERS (Red: 16)...
Logging to wikipedia/experiments/ADPT_run_20260108_185138/M_C/training_output_EleutherAI-pythia-1.4b/stdout
Namespace(dataset_name='wikitext', dataset_config_name='wikitext-2-raw-v1', train_file=None, validation_file=None, validation_split_percentage=5, model_name_or_path='EleutherAI/pythia-1.4b', config_name=None, tokenizer_name=None, use_slow_tokenizer=False, do_ref_model=False, add_adapter=True, adapter_reduction=16, per_device_train_batch_size=1, per_device_eval_batch_size=1, learning_rate=5e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=8, eval_steps=50, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, num_warmup_steps=0, output_dir='wikipedia/experiments/ADPT_run_20260108_185138/M_C', seed=42, model_type=None, block_size=512, preprocessing_num_workers=None, overwrite_cache=False, no_keep_linebreaks=False, push_to_hub=False, hub_model_id=None, hub_token=None, add_canary=False, canary_rep=None, canary_len=5, train_head_only=False, train_layer_n_only=None, canaries_csv='memorization/canaries.csv', inject_canaries_in_training=True)
[Inject canaries] Skipping injection for Canary le_073aa1 (Split: validation)
[Inject canaries] Canary he_3c82e8 injected 1 times. (Split: train)
[Inject canaries] Canary he_b6c479 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_30e20c (Split: validation)
[Inject canaries] Canary he_fa06a9 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_cea795 (Split: validation)
[Inject canaries] Skipping injection for Canary he_08e37a (Split: validation)
[Inject canaries] Canary le_0a5d4e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_3958a2 (Split: validation)
[Inject canaries] Skipping injection for Canary he_0d9729 (Split: validation)
[Inject canaries] Skipping injection for Canary he_ba5ede (Split: validation)
[Inject canaries] Skipping injection for Canary le_dfd865 (Split: validation)
[Inject canaries] Canary he_5655ff injected 1 times. (Split: train)
[Inject canaries] Canary le_7ebcc8 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_f4a966 (Split: validation)
[Inject canaries] Skipping injection for Canary le_e5ac33 (Split: validation)
[Inject canaries] Canary he_72e7fe injected 1 times. (Split: train)
[Inject canaries] Canary le_b76165 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_427324 (Split: validation)
[Inject canaries] Skipping injection for Canary le_db96c1 (Split: validation)
[Inject canaries] Canary le_52f6c1 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_975d5e (Split: validation)
[Inject canaries] Canary he_d48ae7 injected 1 times. (Split: train)
[Inject canaries] Canary le_ea9d6d injected 1 times. (Split: train)
[Inject canaries] Canary le_53a988 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_eb2012 (Split: validation)
[Inject canaries] Skipping injection for Canary le_c38bd0 (Split: validation)
[Inject canaries] Canary le_5e5ef6 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_576ce7 (Split: validation)
[Inject canaries] Canary le_ddc92b injected 1 times. (Split: train)
[Inject canaries] Canary le_8fa52e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_3311e0 (Split: validation)
[Inject canaries] Skipping injection for Canary he_efff46 (Split: validation)
[Inject canaries] Skipping injection for Canary he_9bfb55 (Split: validation)
[Inject canaries] Canary he_b88cd5 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_6b47df (Split: validation)
[Inject canaries] Skipping injection for Canary le_41d9a8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_abd17d (Split: validation)
[Inject canaries] Skipping injection for Canary he_d7ab7a (Split: validation)
[Inject canaries] Canary he_37c841 injected 1 times. (Split: train)
[Inject canaries] Canary le_8be674 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_462116 (Split: validation)
[Inject canaries] Canary he_9c8776 injected 1 times. (Split: train)
[Inject canaries] Canary he_85dce2 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_b62c7a (Split: validation)
[Inject canaries] Canary le_9b9507 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_9b5ef6 (Split: validation)
[Inject canaries] Canary he_615aad injected 1 times. (Split: train)
[Inject canaries] Canary he_3e980e injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary he_6eadd8 (Split: validation)
[Inject canaries] Skipping injection for Canary le_6571ef (Split: validation)
[Inject canaries] Canary le_587750 injected 1 times. (Split: train)
[Inject canaries] Canary le_b4c6a4 injected 1 times. (Split: train)
[Inject canaries] Canary he_79c1cf injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_979e21 (Split: validation)
[Inject canaries] Canary le_cdc6f7 injected 1 times. (Split: train)
[Inject canaries] Canary he_9cb669 injected 1 times. (Split: train)
[Inject canaries] Canary le_4ce813 injected 1 times. (Split: train)
[Inject canaries] Skipping injection for Canary le_7e7fc0 (Split: validation)
[Inject canaries] Canary he_e212a9 injected 1 times. (Split: train)
Casting the dataset:   0%|          | 0/30 [00:00<?, ? examples/s]Casting the dataset: 100%|██████████| 30/30 [00:00<00:00, 47898.41 examples/s]
[Inject canaries] After injection, train size = 36748 (total injected examples = 30)
loading configuration file config.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/config.json
Model config GPTNeoXConfig {
  "architectures": [
    "GPTNeoXForCausalLM"
  ],
  "attention_bias": true,
  "attention_dropout": 0.0,
  "bos_token_id": 0,
  "classifier_dropout": 0.1,
  "dtype": "float16",
  "eos_token_id": 0,
  "hidden_act": "gelu",
  "hidden_dropout": 0.0,
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 8192,
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 2048,
  "model_type": "gpt_neox",
  "num_attention_heads": 16,
  "num_hidden_layers": 24,
  "partial_rotary_factor": 0.25,
  "rope_scaling": null,
  "rope_theta": 10000,
  "rotary_emb_base": 10000,
  "rotary_pct": 0.25,
  "tie_word_embeddings": false,
  "transformers_version": "4.57.3",
  "use_cache": true,
  "use_parallel_residual": true,
  "vocab_size": 50304
}

loading file vocab.json from cache at None
loading file merges.txt from cache at None
loading file tokenizer.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/tokenizer.json
loading file added_tokens.json from cache at None
loading file special_tokens_map.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/special_tokens_map.json
loading file tokenizer_config.json from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/tokenizer_config.json
loading file chat_template.jinja from cache at None
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
`torch_dtype` is deprecated! Use `dtype` instead!
loading weights file model.safetensors from cache at /home/luongo/.cache/huggingface/hub/models--EleutherAI--pythia-1.4b/snapshots/fedc38a16eea3bd36a96b906d78d11d2ce18ed79/model.safetensors
Instantiating GPTNeoXForCausalLM model under default dtype torch.bfloat16.
Generate config GenerationConfig {
  "bos_token_id": 0,
  "eos_token_id": 0
}

Generation config file not found, using a generation config created from the model config.
Could not locate the custom_generate/generate.py inside EleutherAI/pythia-1.4b.
You are resizing the embedding layer without providing a `pad_to_multiple_of` parameter. This means that the new embedding dimension will be 50277. This might induce some performance reduction as *Tensor Cores* will not be available. For more details about this, or help on choosing the correct value for resizing, refer to this guide: https://docs.nvidia.com/deeplearning/performance/dl-performance-matrix-multiplication/index.html#requirements-tc
trainable params: 25,165,824 || all params: 1,439,703,040 || trainable%: 1.7480
model_params (million) 25.165824
model_params (million) 25.165824
01/08/2026 22:21:03 - INFO - __main__ - ***** Running training *****
01/08/2026 22:21:03 - INFO - __main__ -   Num examples = 4686
01/08/2026 22:21:03 - INFO - __main__ -   Num Epochs = 20
01/08/2026 22:21:03 - INFO - __main__ -   Instantaneous batch size per device = 1
01/08/2026 22:21:03 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 8
01/08/2026 22:21:03 - INFO - __main__ -   Gradient Accumulation steps = 8
01/08/2026 22:21:03 - INFO - __main__ -   Total optimization steps = 11720
training epoch 0
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
*************end of epoch 0 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
@-@ 0x4b ='
   Clean Generated:'@-@ 0x4b ='
   Match:          False
threshold is:  2.254725456237793
correct cnt is:  116 all is:  4686 ratio is:  0.024754588134869825
epoch 0: perplexity: 13.642038347899302 perplexity_train: 15.192075379974273
____
0.024754588134869825
13.642038347899302
15.192075379974273
_____
training epoch 1
*************end of epoch 1 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.230556011199951
correct cnt is:  133 all is:  4686 ratio is:  0.028382415706359368
epoch 1: perplexity: 13.50884530785746 perplexity_train: 14.655411966494972
____
0.028382415706359368
13.50884530785746
14.655411966494972
_____
training epoch 2
*************end of epoch 2 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = 
 = ='
   Clean Generated:'= = = = = 
 = ='
   Match:          False
threshold is:  2.2250564098358154
correct cnt is:  154 all is:  4686 ratio is:  0.03286384976525822
epoch 2: perplexity: 13.541323780105895 perplexity_train: 14.342536521922016
____
0.03286384976525822
13.541323780105895
14.342536521922016
_____
training epoch 3
*************end of epoch 3 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.221743106842041
correct cnt is:  168 all is:  4686 ratio is:  0.03585147247119078
epoch 3: perplexity: 13.585850085485632 perplexity_train: 14.102112862355801
____
0.03585147247119078
13.585850085485632
14.102112862355801
_____
training epoch 4
*************end of epoch 4 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.2278833389282227
correct cnt is:  208 all is:  4686 ratio is:  0.04438753734528383
epoch 4: perplexity: 13.562360888460338 perplexity_train: 13.893195038198966
____
0.04438753734528383
13.562360888460338
13.893195038198966
_____
training epoch 5
*************end of epoch 5 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.2252583503723145
correct cnt is:  223 all is:  4686 ratio is:  0.04758856167306871
epoch 5: perplexity: 13.594229030164714 perplexity_train: 13.72823446969502
____
0.04758856167306871
13.594229030164714
13.72823446969502
_____
training epoch 6
*************end of epoch 6 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = 
 ='
   Clean Generated:'= = = = = = 
 ='
   Match:          False
threshold is:  2.2316150665283203
correct cnt is:  256 all is:  4686 ratio is:  0.05463081519419548
epoch 6: perplexity: 13.659802132345243 perplexity_train: 13.573097184714173
____
0.05463081519419548
13.659802132345243
13.573097184714173
_____
training epoch 7
*************end of epoch 7 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.241722345352173
correct cnt is:  287 all is:  4686 ratio is:  0.061246265471617586
epoch 7: perplexity: 13.795861661689116 perplexity_train: 13.437350719285794
____
0.061246265471617586
13.795861661689116
13.437350719285794
_____
training epoch 8
*************end of epoch 8 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  ' , who is a wizard , and Gand'
   Clean Generated:', who is a wizard , and Gand'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.2407994270324707
correct cnt is:  302 all is:  4686 ratio is:  0.06444728979940248
epoch 8: perplexity: 13.799332193315285 perplexity_train: 13.315927644898352
____
0.06444728979940248
13.799332193315285
13.315927644898352
_____
training epoch 9
*************end of epoch 9 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = 
 = ='
   Clean Generated:'= = = = = 
 = ='
   Match:          False
threshold is:  2.2451071739196777
correct cnt is:  345 all is:  4686 ratio is:  0.0736235595390525
epoch 9: perplexity: 13.800230397234763 perplexity_train: 13.190625623370327
____
0.0736235595390525
13.800230397234763
13.190625623370327
_____
training epoch 10
*************end of epoch 10 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.2496707439422607
correct cnt is:  376 all is:  4686 ratio is:  0.08023900981647461
epoch 10: perplexity: 13.91711122309059 perplexity_train: 13.091352086550506
____
0.08023900981647461
13.91711122309059
13.091352086550506
_____
training epoch 11
*************end of epoch 11 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.2509396076202393
correct cnt is:  394 all is:  4686 ratio is:  0.08408023900981647
epoch 11: perplexity: 13.929111317534494 perplexity_train: 13.001440235905214
____
0.08408023900981647
13.929111317534494
13.001440235905214
_____
training epoch 12
*************end of epoch 12 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.251878499984741
correct cnt is:  416 all is:  4686 ratio is:  0.08877507469056765
epoch 12: perplexity: 13.882983364184208 perplexity_train: 12.91685686016672
____
0.08877507469056765
13.882983364184208
12.91685686016672
_____
training epoch 13
*************end of epoch 13 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.262589454650879
correct cnt is:  462 all is:  4686 ratio is:  0.09859154929577464
epoch 13: perplexity: 14.04743535664285 perplexity_train: 12.854408895770856
____
0.09859154929577464
14.04743535664285
12.854408895770856
_____
training epoch 14
*************end of epoch 14 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was released in the United'
   Clean Generated:'The film was released in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = The first and second'
   Clean Generated:'= = = = The first and second'
   Match:          False
threshold is:  2.2603657245635986
correct cnt is:  471 all is:  4686 ratio is:  0.10051216389244558
epoch 14: perplexity: 14.050952424911692 perplexity_train: 12.794574885987876
____
0.10051216389244558
14.050952424911692
12.794574885987876
_____
training epoch 15
*************end of epoch 15 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was shot in the United'
   Clean Generated:'The film was shot in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = The first and second seasons'
   Clean Generated:'= = = The first and second seasons'
   Match:          False
threshold is:  2.259495258331299
correct cnt is:  486 all is:  4686 ratio is:  0.10371318822023047
epoch 15: perplexity: 14.036879393098488 perplexity_train: 12.743836717297361
____
0.10371318822023047
14.036879393098488
12.743836717297361
_____
training epoch 16
*************end of epoch 16 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was released in the United'
   Clean Generated:'The film was released in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = = = = ='
   Clean Generated:'= = = = = = = ='
   Match:          False
threshold is:  2.2623913288116455
correct cnt is:  507 all is:  4686 ratio is:  0.10819462227912932
epoch 16: perplexity: 14.103272871033347 perplexity_train: 12.705656172000584
____
0.10819462227912932
14.103272871033347
12.705656172000584
_____
training epoch 17
*************end of epoch 17 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was released in the United'
   Clean Generated:'The film was released in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = The first and second'
   Clean Generated:'= = = = The first and second'
   Match:          False
threshold is:  2.2623963356018066
correct cnt is:  515 all is:  4686 ratio is:  0.10990183525394794
epoch 17: perplexity: 14.143191485900324 perplexity_train: 12.676251857019986
____
0.10990183525394794
14.143191485900324
12.676251857019986
_____
training epoch 18
*************end of epoch 18 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was released in the United'
   Clean Generated:'The film was released in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = " 
 = ='
   Clean Generated:'= = = = " 
 = ='
   Match:          False
threshold is:  2.264281988143921
correct cnt is:  533 all is:  4686 ratio is:  0.1137430644472898
epoch 18: perplexity: 14.160804281591336 perplexity_train: 12.657295357183013
____
0.1137430644472898
14.160804281591336
12.657295357183013
_____
training epoch 19
*************end of epoch 19 eval 

[DEBUG GENERATION]
   Prefix:         'Gandalf '
   Target Suffix:  'saved a village in the titanic.'
   Raw Generated:  '
The film was released in the United'
   Clean Generated:'The film was released in the United'
   Match:          False

[DEBUG GENERATION]
   Prefix:         'The secure verification code is: '
   Target Suffix:  'OUS84V1t2U1I'
   Raw Generated:  '
= = = = The first and second'
   Clean Generated:'= = = = The first and second'
   Match:          False
threshold is:  2.2650718688964844
correct cnt is:  539 all is:  4686 ratio is:  0.11502347417840375
epoch 19: perplexity: 14.157205710947725 perplexity_train: 12.650700308603666
____
0.11502347417840375
14.157205710947725
12.650700308603666
_____
*************end of training 
threshold is:  2.2650718688964844
correct cnt is:  539 all is:  4686 ratio is:  0.11502347417840375
end of training perplexity: 14.157205710947725 perplexity_train: 12.650700308603666
____
0.11502347417840375
14.157205710947725
12.650700308603666
_____
    -> Timing: 3h 29m 1s

>>> [3/3] Locating Logs and Running Evaluation...
Log M_noC found: wikipedia/experiments/ADPT_run_20260108_185138/M_noC/training_output_EleutherAI-pythia-1.4b/canary_loss_log.csv
Log M_C found:   wikipedia/experiments/ADPT_run_20260108_185138/M_C/training_output_EleutherAI-pythia-1.4b/canary_loss_log.csv
--- 1. LOADING DATA ---
--- DIAGNOSTIC: EPOCH 0 CHECK ---
 > Average Suffix Loss at Epoch 0: Target=5.3688, Reference=5.3869
 OK: Models are aligned at Epoch 0.
---------------------------------
--- 2. PRE-COMPUTING BASELINES ---
   -> Computing historical minimum loss for Reference model...
--- 3. COMPUTING SCORES ---
   -> Merging data and computing scores...
--- 4. RUNNING EPOCH ANALYSIS ---
Epoch 0: MIA=3.33% | EM=0.00% | PPL=213.14 | CTX=0.0055
Epoch 1: MIA=20.00% | EM=0.00% | PPL=218.86 | CTX=0.0050
Epoch 2: MIA=13.33% | EM=0.00% | PPL=220.34 | CTX=0.0056
Epoch 3: MIA=13.33% | EM=0.00% | PPL=226.20 | CTX=0.0056
Epoch 4: MIA=20.00% | EM=0.00% | PPL=225.12 | CTX=0.0054
Epoch 5: MIA=23.33% | EM=0.00% | PPL=229.14 | CTX=0.0056
Epoch 6: MIA=30.00% | EM=0.00% | PPL=227.56 | CTX=0.0054
Epoch 7: MIA=16.67% | EM=0.00% | PPL=231.77 | CTX=0.0065
Epoch 8: MIA=16.67% | EM=0.00% | PPL=230.85 | CTX=0.0055
Epoch 9: MIA=20.00% | EM=0.00% | PPL=234.16 | CTX=0.0058
Epoch 10: MIA=20.00% | EM=0.00% | PPL=233.47 | CTX=0.0060
Epoch 11: MIA=16.67% | EM=0.00% | PPL=237.52 | CTX=0.0049
Epoch 12: MIA=23.33% | EM=0.00% | PPL=236.23 | CTX=0.0069
Epoch 13: MIA=23.33% | EM=0.00% | PPL=237.59 | CTX=0.0066
Epoch 14: MIA=23.33% | EM=0.00% | PPL=234.01 | CTX=0.0076
Epoch 15: MIA=16.67% | EM=0.00% | PPL=239.26 | CTX=0.0067
Epoch 16: MIA=10.00% | EM=0.00% | PPL=238.88 | CTX=0.0056
Epoch 17: MIA=20.00% | EM=0.00% | PPL=239.35 | CTX=0.0060
Epoch 18: MIA=20.00% | EM=0.00% | PPL=239.66 | CTX=0.0065
Epoch 19: MIA=13.33% | EM=0.00% | PPL=240.47 | CTX=0.0060
--- 5. SAVING RESULTS ---
Done. Results in: wikipedia/experiments/ADPT_run_20260108_185138/results

==================================================================
ADAPTER EXPERIMENT FINISHED SUCCESSFULLY!
Results are available in: wikipedia/experiments/ADPT_run_20260108_185138/results
    -> Timing: 6h 58m 16s
==================================================================
